

--- Transform ---


Load pickle from features/parse_calendar.pkl.
Load pickle from features/parse_sell_prices.pkl.
Load pickle from features/parse_sales_train.pkl.
Load pickle from features/melted_and_merged_train.pkl.


--- Create Features ---


Load pickle from features/all_data.pkl.


--- Split Data ---


<class 'pandas.core.frame.DataFrame'>
RangeIndex: 35093990 entries, 24940820 to 60034809
Data columns (total 249 columns):
 #   Column                                                    Dtype         
---  ------                                                    -----         
 0   id                                                        object        
 1   item_id                                                   category      
 2   dept_id                                                   category      
 3   cat_id                                                    category      
 4   store_id                                                  category      
 5   state_id                                                  category      
 6   d                                                         int16         
 7   sales                                                     float16       
 8   date                                                      datetime64[ns]
 9   wm_yr_wk                                                  int16         
 10  event_name_1                                              category      
 11  event_type_1                                              category      
 12  event_name_2                                              category      
 13  event_type_2                                              category      
 14  snap_CA                                                   int8          
 15  snap_TX                                                   int8          
 16  snap_WI                                                   int8          
 17  year                                                      int16         
 18  quarter                                                   int8          
 19  month                                                     int8          
 20  week                                                      int8          
 21  day                                                       int8          
 22  dayofweek                                                 int8          
 23  dayofyear                                                 int16         
 24  is_month_end                                              bool          
 25  is_month_start                                            bool          
 26  is_weekend                                                bool          
 27  nwd_CA                                                    int8          
 28  nwd_TX                                                    int8          
 29  nwd_WI                                                    int8          
 30  nwd_CA_rolling_t7                                         int8          
 31  nwd_CA_rolling_t14                                        int8          
 32  nwd_CA_rolling_t28                                        int8          
 33  nwd_TX_rolling_t7                                         int8          
 34  nwd_TX_rolling_t14                                        int8          
 35  nwd_TX_rolling_t28                                        int8          
 36  nwd_WI_rolling_t7                                         int8          
 37  nwd_WI_rolling_t14                                        int8          
 38  nwd_WI_rolling_t28                                        int8          
 39  sell_price                                                float16       
 40  price_max                                                 float16       
 41  price_min                                                 float16       
 42  price_std                                                 float16       
 43  price_mean                                                float16       
 44  price_nunique                                             float16       
 45  release                                                   float16       
 46  id_nunique_by_price                                       float16       
 47  price_float                                               float16       
 48  price_int                                                 float16       
 49  price_norm                                                float16       
 50  sales_lag_t0                                              float16       
 51  sales_lag_t1                                              float16       
 52  sales_lag_t2                                              float16       
 53  sales_lag_t3                                              float16       
 54  sales_lag_t4                                              float16       
 55  sales_lag_t5                                              float16       
 56  sales_lag_t6                                              float16       
 57  sales_lag_t7                                              float16       
 58  sales_lag_t8                                              float16       
 59  sales_lag_t9                                              float16       
 60  sales_lag_t10                                             float16       
 61  sales_lag_t11                                             float16       
 62  sales_lag_t12                                             float16       
 63  sales_lag_t13                                             float16       
 64  sales_lag_t14                                             float16       
 65  sales_roll_mean_t1_7                                      float16       
 66  sales_roll_std_t1_7                                       float16       
 67  sales_roll_min_t1_7                                       float16       
 68  sales_roll_max_t1_7                                       float16       
 69  sales_roll_mean_t1_14                                     float16       
 70  sales_roll_std_t1_14                                      float16       
 71  sales_roll_min_t1_14                                      float16       
 72  sales_roll_max_t1_14                                      float16       
 73  sales_roll_mean_t1_30                                     float16       
 74  sales_roll_std_t1_30                                      float16       
 75  sales_roll_min_t1_30                                      float16       
 76  sales_roll_max_t1_30                                      float16       
 77  sales_roll_mean_t7_7                                      float16       
 78  sales_roll_std_t7_7                                       float16       
 79  sales_roll_min_t7_7                                       float16       
 80  sales_roll_max_t7_7                                       float16       
 81  sales_roll_mean_t7_14                                     float16       
 82  sales_roll_std_t7_14                                      float16       
 83  sales_roll_min_t7_14                                      float16       
 84  sales_roll_max_t7_14                                      float16       
 85  sales_roll_mean_t7_30                                     float16       
 86  sales_roll_std_t7_30                                      float16       
 87  sales_roll_min_t7_30                                      float16       
 88  sales_roll_max_t7_30                                      float16       
 89  sales_roll_mean_t14_7                                     float16       
 90  sales_roll_std_t14_7                                      float16       
 91  sales_roll_min_t14_7                                      float16       
 92  sales_roll_max_t14_7                                      float16       
 93  sales_roll_mean_t14_14                                    float16       
 94  sales_roll_std_t14_14                                     float16       
 95  sales_roll_min_t14_14                                     float16       
 96  sales_roll_max_t14_14                                     float16       
 97  sales_roll_mean_t14_30                                    float16       
 98  sales_roll_std_t14_30                                     float16       
 99  sales_roll_min_t14_30                                     float16       
 100 sales_roll_max_t14_30                                     float16       
 101 sales_rolling_ZeroRatio_t7                                float16       
 102 sales_rolling_ZeroCount_t7                                float16       
 103 sales_rolling_NonZeroRatio_t7                             float16       
 104 sales_rolling_NonZeroCount_t7                             float16       
 105 sales_rolling_ZeroRatio_t14                               float16       
 106 sales_rolling_ZeroCount_t14                               float16       
 107 sales_rolling_NonZeroRatio_t14                            float16       
 108 sales_rolling_NonZeroCount_t14                            float16       
 109 sales_rolling_ZeroRatio_t30                               float16       
 110 sales_rolling_ZeroCount_t30                               float16       
 111 sales_rolling_NonZeroRatio_t30                            float16       
 112 sales_rolling_NonZeroCount_t30                            float16       
 113 sales_rolling_skew_t30                                    float16       
 114 sales_rolling_kurt_t30                                    float16       
 115 total_sales_lag_t0                                        float16       
 116 total_sales_lag_t1                                        float16       
 117 total_sales_lag_t2                                        float16       
 118 total_sales_lag_t3                                        float16       
 119 total_sales_lag_t4                                        float16       
 120 total_sales_lag_t5                                        float16       
 121 total_sales_lag_t6                                        float16       
 122 total_sales_lag_t7                                        float16       
 123 total_sales_lag_t8                                        float16       
 124 total_sales_lag_t9                                        float16       
 125 total_sales_lag_t10                                       float16       
 126 total_sales_lag_t11                                       float16       
 127 total_sales_lag_t12                                       float16       
 128 total_sales_lag_t13                                       float16       
 129 total_sales_lag_t14                                       float16       
 130 total_sales_roll_mean_t1_7                                float16       
 131 total_sales_roll_std_t1_7                                 float16       
 132 total_sales_roll_mean_t1_14                               float16       
 133 total_sales_roll_std_t1_14                                float16       
 134 total_sales_roll_mean_t1_30                               float16       
 135 total_sales_roll_std_t1_30                                float16       
 136 total_sales_roll_mean_t7_7                                float16       
 137 total_sales_roll_std_t7_7                                 float16       
 138 total_sales_roll_mean_t7_14                               float16       
 139 total_sales_roll_std_t7_14                                float16       
 140 total_sales_roll_mean_t7_30                               float16       
 141 total_sales_roll_std_t7_30                                float16       
 142 total_sales_roll_mean_t14_7                               float16       
 143 total_sales_roll_std_t14_7                                float16       
 144 total_sales_roll_mean_t14_14                              float16       
 145 total_sales_roll_std_t14_14                               float16       
 146 total_sales_roll_mean_t14_30                              float16       
 147 total_sales_roll_std_t14_30                               float16       
 148 price_momentum                                            float16       
 149 price_momentum_m                                          float16       
 150 days_from_last_sales                                      int16         
 151 enc_sales_mean_by_state_id                                float16       
 152 enc_sales_std_by_state_id                                 float16       
 153 enc_sales_mean_by_store_id                                float16       
 154 enc_sales_std_by_store_id                                 float16       
 155 enc_sales_mean_by_cat_id                                  float16       
 156 enc_sales_std_by_cat_id                                   float16       
 157 enc_sales_mean_by_dept_id                                 float16       
 158 enc_sales_std_by_dept_id                                  float16       
 159 enc_sales_mean_by_state_id_cat_id                         float16       
 160 enc_sales_std_by_state_id_cat_id                          float16       
 161 enc_sales_mean_by_state_id_dept_id                        float16       
 162 enc_sales_std_by_state_id_dept_id                         float16       
 163 enc_sales_mean_by_store_id_cat_id                         float16       
 164 enc_sales_std_by_store_id_cat_id                          float16       
 165 enc_sales_mean_by_store_id_dept_id                        float16       
 166 enc_sales_std_by_store_id_dept_id                         float16       
 167 enc_sales_mean_by_item_id                                 float16       
 168 enc_sales_std_by_item_id                                  float16       
 169 enc_sales_mean_by_item_id_state_id                        float16       
 170 enc_sales_std_by_item_id_state_id                         float16       
 171 enc_sales_mean_by_item_id_store_id                        float16       
 172 enc_sales_std_by_item_id_store_id                         float16       
 173 enc_sales_mean_by_store_id_dayofweek                      float16       
 174 enc_sales_std_by_store_id_dayofweek                       float16       
 175 enc_sales_mean_by_dept_id_dayofweek                       float16       
 176 enc_sales_std_by_dept_id_dayofweek                        float16       
 177 enc_sales_mean_by_item_id_dayofweek                       float16       
 178 enc_sales_std_by_item_id_dayofweek                        float16       
 179 enc_sales_mean_by_store_id_dept_id_dayofweek              float16       
 180 enc_sales_std_by_store_id_dept_id_dayofweek               float16       
 181 enc_sales_mean_by_store_id_dept_id_week                   float16       
 182 enc_sales_std_by_store_id_dept_id_week                    float16       
 183 enc_sales_mean_by_store_id_dept_id_day                    float16       
 184 enc_sales_std_by_store_id_dept_id_day                     float16       
 185 enc_sales_mean_by_store_id_item_id_dayofweek              float16       
 186 enc_sales_std_by_store_id_item_id_dayofweek               float16       
 187 enc_sales_mean_by_store_id_item_id_week                   float16       
 188 enc_sales_std_by_store_id_item_id_week                    float16       
 189 enc_sales_mean_by_store_id_item_id_day                    float16       
 190 enc_sales_std_by_store_id_item_id_day                     float16       
 191 enc_sales_mean_by_store_id_item_id_nwd_CA                 float16       
 192 enc_sales_std_by_store_id_item_id_nwd_CA                  float16       
 193 enc_sales_mean_by_store_id_item_id_nwd_TX                 float16       
 194 enc_sales_std_by_store_id_item_id_nwd_TX                  float16       
 195 enc_sales_mean_by_store_id_item_id_nwd_WI                 float16       
 196 enc_sales_std_by_store_id_item_id_nwd_WI                  float16       
 197 enc_sales_mean_by_store_id_item_id_is_weekend             float16       
 198 enc_sales_std_by_store_id_item_id_is_weekend              float16       
 199 enc_sales_times_price_mean_by_state_id                    float16       
 200 enc_sales_times_price_std_by_state_id                     float16       
 201 enc_sales_times_price_mean_by_store_id                    float16       
 202 enc_sales_times_price_std_by_store_id                     float16       
 203 enc_sales_times_price_mean_by_cat_id                      float16       
 204 enc_sales_times_price_std_by_cat_id                       float16       
 205 enc_sales_times_price_mean_by_dept_id                     float16       
 206 enc_sales_times_price_std_by_dept_id                      float16       
 207 enc_sales_times_price_mean_by_state_id_cat_id             float16       
 208 enc_sales_times_price_std_by_state_id_cat_id              float16       
 209 enc_sales_times_price_mean_by_state_id_dept_id            float16       
 210 enc_sales_times_price_std_by_state_id_dept_id             float16       
 211 enc_sales_times_price_mean_by_store_id_cat_id             float16       
 212 enc_sales_times_price_std_by_store_id_cat_id              float16       
 213 enc_sales_times_price_mean_by_store_id_dept_id            float16       
 214 enc_sales_times_price_std_by_store_id_dept_id             float16       
 215 enc_sales_times_price_mean_by_item_id                     float16       
 216 enc_sales_times_price_std_by_item_id                      float16       
 217 enc_sales_times_price_mean_by_item_id_state_id            float16       
 218 enc_sales_times_price_std_by_item_id_state_id             float16       
 219 enc_sales_times_price_mean_by_item_id_store_id            float16       
 220 enc_sales_times_price_std_by_item_id_store_id             float64       
 221 enc_sales_times_price_mean_by_store_id_dayofweek          float16       
 222 enc_sales_times_price_std_by_store_id_dayofweek           float16       
 223 enc_sales_times_price_mean_by_dept_id_dayofweek           float16       
 224 enc_sales_times_price_std_by_dept_id_dayofweek            float16       
 225 enc_sales_times_price_mean_by_item_id_dayofweek           float16       
 226 enc_sales_times_price_std_by_item_id_dayofweek            float16       
 227 enc_sales_times_price_mean_by_store_id_dept_id_dayofweek  float16       
 228 enc_sales_times_price_std_by_store_id_dept_id_dayofweek   float16       
 229 enc_sales_times_price_mean_by_store_id_item_id_dayofweek  float16       
 230 enc_sales_times_price_std_by_store_id_item_id_dayofweek   float64       
 231 gte_state_id_MEAN                                         float64       
 232 gte_store_id_MEAN                                         float64       
 233 gte_cat_id_MEAN                                           float64       
 234 gte_dept_id_MEAN                                          float64       
 235 gte_item_id_MEAN                                          float64       
 236 gte_state_id_dept_id_MEAN                                 float64       
 237 gte_state_id_item_id_MEAN                                 float64       
 238 gte_store_id_dept_id_MEAN                                 float64       
 239 gte_store_id_item_id_MEAN                                 float64       
 240 gte_state_id_VAR                                          float16       
 241 gte_store_id_VAR                                          float16       
 242 gte_cat_id_VAR                                            float16       
 243 gte_dept_id_VAR                                           float16       
 244 gte_item_id_VAR                                           float16       
 245 gte_state_id_dept_id_VAR                                  float16       
 246 gte_state_id_item_id_VAR                                  float16       
 247 gte_store_id_dept_id_VAR                                  float16       
 248 gte_store_id_item_id_VAR                                  float16       
dtypes: bool(3), category(9), datetime64[ns](1), float16(199), float64(11), int16(5), int8(20), object(1)
memory usage: 17.8+ GB
None 

Dump Train Data.
1/10, Dump pickle to features/train_data_CA_1.pkl.
2/10, Dump pickle to features/train_data_CA_2.pkl.
3/10, Dump pickle to features/train_data_CA_3.pkl.
4/10, Dump pickle to features/train_data_CA_4.pkl.
5/10, Dump pickle to features/train_data_TX_1.pkl.
6/10, Dump pickle to features/train_data_TX_2.pkl.
7/10, Dump pickle to features/train_data_TX_3.pkl.
8/10, Dump pickle to features/train_data_WI_1.pkl.
9/10, Dump pickle to features/train_data_WI_2.pkl.
10/10, Dump pickle to features/train_data_WI_3.pkl.
Dump Evaluation Data.
Dump pickle to features/eval_data.pkl.
Dump Submisssion Data.
Split submit_data to features/submit_data.pkl
Dump pickle to features/submit_data.pkl.


--- Define Evaluator ---


Dump pickle to features/evaluator.pkl.
#########################
##### Fold 1 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 42,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('CA_1',), 1/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0902101
[200]	valid_0's WRMSSE: 0.089171
[300]	valid_0's WRMSSE: 0.0890546
Early stopping, best iteration is:
[276]	valid_0's WRMSSE: 0.0889893


Group ID: ('CA_2',), 2/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0966624
[200]	valid_0's WRMSSE: 0.0949377
[300]	valid_0's WRMSSE: 0.094387
[400]	valid_0's WRMSSE: 0.094188
[500]	valid_0's WRMSSE: 0.0939491
[600]	valid_0's WRMSSE: 0.0938906
[700]	valid_0's WRMSSE: 0.0937964
[800]	valid_0's WRMSSE: 0.093786
Early stopping, best iteration is:
[775]	valid_0's WRMSSE: 0.0937745


Group ID: ('CA_3',), 3/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.12991
[200]	valid_0's WRMSSE: 0.127878
[300]	valid_0's WRMSSE: 0.127058
[400]	valid_0's WRMSSE: 0.126966
[500]	valid_0's WRMSSE: 0.126744
[600]	valid_0's WRMSSE: 0.126626
[700]	valid_0's WRMSSE: 0.126702
Early stopping, best iteration is:
[635]	valid_0's WRMSSE: 0.126585


Group ID: ('CA_4',), 4/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0538941
[200]	valid_0's WRMSSE: 0.0534193
[300]	valid_0's WRMSSE: 0.0533608
[400]	valid_0's WRMSSE: 0.0533497
[500]	valid_0's WRMSSE: 0.0533232
Early stopping, best iteration is:
[449]	valid_0's WRMSSE: 0.0533103


Group ID: ('TX_1',), 5/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0645471
[200]	valid_0's WRMSSE: 0.0639889
[300]	valid_0's WRMSSE: 0.0638708
Early stopping, best iteration is:
[287]	valid_0's WRMSSE: 0.0638591


Group ID: ('TX_2',), 6/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0740078
[200]	valid_0's WRMSSE: 0.0737413
Early stopping, best iteration is:
[157]	valid_0's WRMSSE: 0.0736585


Group ID: ('TX_3',), 7/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0806376
[200]	valid_0's WRMSSE: 0.0801248
[300]	valid_0's WRMSSE: 0.0801142
Early stopping, best iteration is:
[220]	valid_0's WRMSSE: 0.0800335


Group ID: ('WI_1',), 8/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0721964
[200]	valid_0's WRMSSE: 0.071139
[300]	valid_0's WRMSSE: 0.0709568
[400]	valid_0's WRMSSE: 0.0709351
[500]	valid_0's WRMSSE: 0.0710294
Early stopping, best iteration is:
[404]	valid_0's WRMSSE: 0.0709286


Group ID: ('WI_2',), 9/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.111566
[200]	valid_0's WRMSSE: 0.109561
[300]	valid_0's WRMSSE: 0.109304
[400]	valid_0's WRMSSE: 0.109321
Early stopping, best iteration is:
[338]	valid_0's WRMSSE: 0.109254


Group ID: ('WI_3',), 10/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0724969
[200]	valid_0's WRMSSE: 0.0717877
Early stopping, best iteration is:
[173]	valid_0's WRMSSE: 0.0717501

Dump pickle to result/model/v08002.pkl.


--- Evaluation ---


Load pickle from result/model/v08002.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08002.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.11374288313328
Our val WRMSSE score is 0.5150896314222724


--- Submission ---


Load pickle from result/model/v08002.pkl.
Load pickle from result/feature_cols/v08002.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.868302  0.869772  0.876366  1.074974   
1  HOBBIES_1_002_CA_1_validation  0.176359  0.138476  0.176764  0.204954   
2  HOBBIES_1_003_CA_1_validation  0.267152  0.332055  0.370590  0.323253   
3  HOBBIES_1_004_CA_1_validation  1.642917  1.553866  1.528913  1.567008   
4  HOBBIES_1_005_CA_1_validation  0.894194  0.669875  0.912581  0.857640   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.917042  1.505274  1.845864  0.571605  0.565552  0.613202  0.482111   
1  0.194550  0.217897  0.266820  0.259432  0.349461  0.332375  0.274426   
2  0.384806  0.457096  0.570183  0.313970  0.298132  0.266231  0.462892   
3  1.895344  2.536927  3.360196  1.863104  1.667938  1.610734  1.845783   
4  0.871257  1.075873  1.312105  1.255150  1.042626  0.949838  0.876317   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.622339  1.033624  0.753342  0.831025  0.582747  0.600452  0.697396   
1  0.340256  0.318550  0.353227  0.234950  0.247053  0.257610  0.240163   
2  0.324299  0.783222  0.671460  0.381141  0.423942  0.437835  0.441871   
3  2.227586  4.142014  3.650748  1.585761  1.323793  1.354032  1.395675   
4  0.969692  1.635156  1.287719  0.623547  0.625791  0.637160  0.661466   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.701061  1.271925  0.754073  0.621853  0.527445  0.453344  0.580826   
1  0.173089  0.349898  0.353894  0.248368  0.237367  0.225730  0.291499   
2  0.582692  0.569641  0.649183  0.438611  0.315870  0.404679  0.532253   
3  1.330179  2.465146  2.869069  2.159224  1.720547  1.676705  1.460022   
4  0.703407  0.877736  0.895973  1.206835  1.053216  1.305921  1.319804   

        F26       F27       F28  
0  0.682218  0.793824  0.838270  
1  0.272586  0.335483  0.358864  
2  0.540436  0.498435  0.722888  
3  2.133692  3.365070  4.046326  
4  1.377762  2.578216  2.162733  
#########################
##### Fold 2 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 43,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('CA_1',), 1/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0896356
[200]	valid_0's WRMSSE: 0.0886735
[300]	valid_0's WRMSSE: 0.0883928
Early stopping, best iteration is:
[287]	valid_0's WRMSSE: 0.0883803


Group ID: ('CA_2',), 2/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0969179
[200]	valid_0's WRMSSE: 0.0948251
[300]	valid_0's WRMSSE: 0.0943011
[400]	valid_0's WRMSSE: 0.0939803
[500]	valid_0's WRMSSE: 0.093796
[600]	valid_0's WRMSSE: 0.0937631
[700]	valid_0's WRMSSE: 0.093717
[800]	valid_0's WRMSSE: 0.0937016
Early stopping, best iteration is:
[709]	valid_0's WRMSSE: 0.0936928


Group ID: ('CA_3',), 3/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.129631
[200]	valid_0's WRMSSE: 0.127277
[300]	valid_0's WRMSSE: 0.126854
[400]	valid_0's WRMSSE: 0.12677
[500]	valid_0's WRMSSE: 0.126825
Early stopping, best iteration is:
[448]	valid_0's WRMSSE: 0.126715


Group ID: ('CA_4',), 4/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0539136
[200]	valid_0's WRMSSE: 0.0534014
[300]	valid_0's WRMSSE: 0.0532867
[400]	valid_0's WRMSSE: 0.0532561
Early stopping, best iteration is:
[387]	valid_0's WRMSSE: 0.0532512


Group ID: ('TX_1',), 5/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0646358
[200]	valid_0's WRMSSE: 0.0640799
[300]	valid_0's WRMSSE: 0.0640103
[400]	valid_0's WRMSSE: 0.0640016
Early stopping, best iteration is:
[368]	valid_0's WRMSSE: 0.0639744


Group ID: ('TX_2',), 6/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0738165
[200]	valid_0's WRMSSE: 0.0733785
[300]	valid_0's WRMSSE: 0.0733645
Early stopping, best iteration is:
[287]	valid_0's WRMSSE: 0.0733244


Group ID: ('TX_3',), 7/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0805301
[200]	valid_0's WRMSSE: 0.0798941
[300]	valid_0's WRMSSE: 0.0798215
[400]	valid_0's WRMSSE: 0.0798717
Early stopping, best iteration is:
[318]	valid_0's WRMSSE: 0.0797852


Group ID: ('WI_1',), 8/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0720834
[200]	valid_0's WRMSSE: 0.0711936
[300]	valid_0's WRMSSE: 0.0710375
Early stopping, best iteration is:
[270]	valid_0's WRMSSE: 0.0709974


Group ID: ('WI_2',), 9/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.111301
[200]	valid_0's WRMSSE: 0.108974
[300]	valid_0's WRMSSE: 0.108793
Early stopping, best iteration is:
[242]	valid_0's WRMSSE: 0.1087


Group ID: ('WI_3',), 10/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0725321
[200]	valid_0's WRMSSE: 0.0714775
[300]	valid_0's WRMSSE: 0.0715025
Early stopping, best iteration is:
[270]	valid_0's WRMSSE: 0.071437

Dump pickle to result/model/v08002.pkl.


--- Evaluation ---


Load pickle from result/model/v08002.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08002.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.129327270753775
Our val WRMSSE score is 0.520637464294766


--- Submission ---


Load pickle from result/model/v08002.pkl.
Load pickle from result/feature_cols/v08002.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.795003  0.815363  0.880950  1.125273   
1  HOBBIES_1_002_CA_1_validation  0.174669  0.134877  0.177599  0.205294   
2  HOBBIES_1_003_CA_1_validation  0.286035  0.340111  0.384840  0.326476   
3  HOBBIES_1_004_CA_1_validation  1.629250  1.563903  1.534748  1.608588   
4  HOBBIES_1_005_CA_1_validation  0.818699  0.641955  0.812176  0.785303   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.843619  1.477847  1.733954  0.572671  0.539703  0.554111  0.457262   
1  0.195591  0.222019  0.262324  0.277115  0.340828  0.331946  0.278046   
2  0.390765  0.438410  0.522021  0.326292  0.315334  0.276962  0.438604   
3  1.783261  2.367481  3.312297  1.719334  1.610653  1.468929  1.875261   
4  0.821440  1.036073  1.204933  1.252249  1.013074  0.886436  0.852014   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.631694  1.004599  0.727934  0.828938  0.559647  0.597328  0.680002   
1  0.340093  0.323396  0.362558  0.240065  0.253839  0.257084  0.238353   
2  0.339152  0.726156  0.609058  0.373200  0.403182  0.400855  0.403890   
3  2.112833  4.109184  3.377957  1.448899  1.193302  1.214269  1.317290   
4  0.949025  1.610085  1.223568  0.596275  0.619733  0.629392  0.616060   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.726425  1.233111  0.774061  0.627400  0.542160  0.464516  0.579348   
1  0.178240  0.345962  0.346017  0.245401  0.235835  0.224539  0.285985   
2  0.537744  0.535939  0.612577  0.412362  0.319894  0.402009  0.574849   
3  1.258789  2.277571  2.321974  2.108185  1.626557  1.627589  1.455931   
4  0.684726  0.873872  0.867429  1.163765  1.011879  1.250710  1.248520   

        F26       F27       F28  
0  0.713537  0.771709  0.809545  
1  0.270858  0.318164  0.359455  
2  0.552945  0.517415  0.722827  
3  2.108042  3.569361  4.170403  
4  1.330967  2.329696  2.113385  
#########################
##### Fold 3 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 45,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('CA_1',), 1/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0900802
[200]	valid_0's WRMSSE: 0.0893041
[300]	valid_0's WRMSSE: 0.0890201
[400]	valid_0's WRMSSE: 0.0888777
[500]	valid_0's WRMSSE: 0.088962
Early stopping, best iteration is:
[401]	valid_0's WRMSSE: 0.0888774


Group ID: ('CA_2',), 2/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0967752
[200]	valid_0's WRMSSE: 0.0949869
[300]	valid_0's WRMSSE: 0.0944764
[400]	valid_0's WRMSSE: 0.094214
[500]	valid_0's WRMSSE: 0.094096
Early stopping, best iteration is:
[495]	valid_0's WRMSSE: 0.0940787


Group ID: ('CA_3',), 3/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.129537
[200]	valid_0's WRMSSE: 0.127529
[300]	valid_0's WRMSSE: 0.127141
[400]	valid_0's WRMSSE: 0.126828
[500]	valid_0's WRMSSE: 0.12689
Early stopping, best iteration is:
[449]	valid_0's WRMSSE: 0.126809


Group ID: ('CA_4',), 4/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.053979
[200]	valid_0's WRMSSE: 0.0535059
[300]	valid_0's WRMSSE: 0.0534394
Early stopping, best iteration is:
[275]	valid_0's WRMSSE: 0.0534177


Group ID: ('TX_1',), 5/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.064668
[200]	valid_0's WRMSSE: 0.0640718
[300]	valid_0's WRMSSE: 0.0639614
[400]	valid_0's WRMSSE: 0.0639936
Early stopping, best iteration is:
[310]	valid_0's WRMSSE: 0.0639465


Group ID: ('TX_2',), 6/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0738273
[200]	valid_0's WRMSSE: 0.0735138
Early stopping, best iteration is:
[170]	valid_0's WRMSSE: 0.0734471


Group ID: ('TX_3',), 7/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0807552
[200]	valid_0's WRMSSE: 0.0801217
[300]	valid_0's WRMSSE: 0.0801285
Early stopping, best iteration is:
[240]	valid_0's WRMSSE: 0.0800188


Group ID: ('WI_1',), 8/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0721015
[200]	valid_0's WRMSSE: 0.0712187
[300]	valid_0's WRMSSE: 0.0711243
Early stopping, best iteration is:
[244]	valid_0's WRMSSE: 0.0711102


Group ID: ('WI_2',), 9/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.11212
[200]	valid_0's WRMSSE: 0.109904
[300]	valid_0's WRMSSE: 0.109594
Early stopping, best iteration is:
[266]	valid_0's WRMSSE: 0.109495


Group ID: ('WI_3',), 10/10
Dump pickle to result/feature_cols/v08002.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.073092
[200]	valid_0's WRMSSE: 0.0722933
[300]	valid_0's WRMSSE: 0.0721374
Early stopping, best iteration is:
[250]	valid_0's WRMSSE: 0.072117

Dump pickle to result/model/v08002.pkl.


--- Evaluation ---


Load pickle from result/model/v08002.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08002.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.1182172607484744
Our val WRMSSE score is 0.5229616557092257


--- Submission ---


Load pickle from result/model/v08002.pkl.
Load pickle from result/feature_cols/v08002.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.804411  0.815292  0.948374  1.220179   
1  HOBBIES_1_002_CA_1_validation  0.166490  0.128816  0.170393  0.208818   
2  HOBBIES_1_003_CA_1_validation  0.265003  0.353437  0.411727  0.342825   
3  HOBBIES_1_004_CA_1_validation  1.670673  1.569909  1.542217  1.687358   
4  HOBBIES_1_005_CA_1_validation  0.834974  0.610752  0.848611  0.802584   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.933484  1.405624  1.776897  0.583712  0.588747  0.657978  0.483613   
1  0.191058  0.209659  0.264367  0.256084  0.363218  0.340697  0.267112   
2  0.418259  0.473705  0.569573  0.321609  0.320447  0.275091  0.454107   
3  1.950218  2.789001  3.918197  1.819902  1.718414  1.584129  2.072650   
4  0.845237  1.045572  1.197979  1.240901  1.020668  0.897579  0.846441   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.639528  1.113218  0.717695  0.881516  0.591070  0.634720  0.793455   
1  0.336393  0.326005  0.348172  0.229968  0.253638  0.258145  0.235628   
2  0.329897  0.832356  0.679696  0.393430  0.438838  0.424932  0.438232   
3  2.399714  4.267040  3.456905  1.640782  1.270522  1.318900  1.358754   
4  0.952276  1.659429  1.181463  0.574530  0.597923  0.621836  0.626105   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.741229  1.358657  0.723181  0.678288  0.553776  0.461043  0.654709   
1  0.171789  0.366312  0.369531  0.249397  0.241832  0.220538  0.311569   
2  0.606477  0.602216  0.669694  0.434056  0.325064  0.422335  0.631081   
3  1.344564  2.465126  2.663297  2.414632  1.679515  1.726181  1.559776   
4  0.671817  0.882747  0.887245  1.233081  1.046896  1.281052  1.304831   

        F26       F27       F28  
0  0.772901  0.803973  0.900091  
1  0.278506  0.346990  0.375063  
2  0.594810  0.527089  0.789561  
3  2.444516  3.663343  4.433865  
4  1.423361  2.459676  2.197877  
