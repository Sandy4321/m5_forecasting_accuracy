

--- Transform ---


Load pickle from features/parse_calendar.pkl.
Load pickle from features/parse_sell_prices.pkl.
Load pickle from features/parse_sales_train.pkl.
Load pickle from features/melted_and_merged_train.pkl.


--- Create Features ---


Load pickle from features/sales_lag_and_roll.pkl.
Load pickle from features/total_sales_lag_and_roll.pkl.
Load pickle from features/price_simple_feature.pkl.
Load pickle from features/days_from_last_sales.pkl.
Load pickle from features/simple_target_encoding.pkl.
Load pickle from features/simple_total_sales_encoding.pkl.
Load pickle from features/hierarchical_bayesian_target_encoding.pkl.
Dump pickle to features/all_data.pkl.


--- Split Data ---


<class 'pandas.core.frame.DataFrame'>
RangeIndex: 23965140 entries, 36069670 to 60034809
Data columns (total 249 columns):
 #   Column                                                    Dtype         
---  ------                                                    -----         
 0   id                                                        object        
 1   item_id                                                   category      
 2   dept_id                                                   category      
 3   cat_id                                                    category      
 4   store_id                                                  category      
 5   state_id                                                  category      
 6   d                                                         int16         
 7   sales                                                     float16       
 8   date                                                      datetime64[ns]
 9   wm_yr_wk                                                  int16         
 10  event_name_1                                              category      
 11  event_type_1                                              category      
 12  event_name_2                                              category      
 13  event_type_2                                              category      
 14  snap_CA                                                   int8          
 15  snap_TX                                                   int8          
 16  snap_WI                                                   int8          
 17  year                                                      int16         
 18  quarter                                                   int8          
 19  month                                                     int8          
 20  week                                                      int8          
 21  day                                                       int8          
 22  dayofweek                                                 int8          
 23  dayofyear                                                 int16         
 24  is_month_end                                              bool          
 25  is_month_start                                            bool          
 26  is_weekend                                                bool          
 27  nwd_CA                                                    int8          
 28  nwd_TX                                                    int8          
 29  nwd_WI                                                    int8          
 30  nwd_CA_rolling_t7                                         int8          
 31  nwd_CA_rolling_t14                                        int8          
 32  nwd_CA_rolling_t28                                        int8          
 33  nwd_TX_rolling_t7                                         int8          
 34  nwd_TX_rolling_t14                                        int8          
 35  nwd_TX_rolling_t28                                        int8          
 36  nwd_WI_rolling_t7                                         int8          
 37  nwd_WI_rolling_t14                                        int8          
 38  nwd_WI_rolling_t28                                        int8          
 39  sell_price                                                float16       
 40  price_max                                                 float16       
 41  price_min                                                 float16       
 42  price_std                                                 float16       
 43  price_mean                                                float16       
 44  price_nunique                                             float16       
 45  release                                                   float16       
 46  id_nunique_by_price                                       float16       
 47  price_float                                               float16       
 48  price_int                                                 float16       
 49  price_norm                                                float16       
 50  sales_lag_t0                                              float16       
 51  sales_lag_t1                                              float16       
 52  sales_lag_t2                                              float16       
 53  sales_lag_t3                                              float16       
 54  sales_lag_t4                                              float16       
 55  sales_lag_t5                                              float16       
 56  sales_lag_t6                                              float16       
 57  sales_lag_t7                                              float16       
 58  sales_lag_t8                                              float16       
 59  sales_lag_t9                                              float16       
 60  sales_lag_t10                                             float16       
 61  sales_lag_t11                                             float16       
 62  sales_lag_t12                                             float16       
 63  sales_lag_t13                                             float16       
 64  sales_lag_t14                                             float16       
 65  sales_roll_mean_t1_7                                      float16       
 66  sales_roll_std_t1_7                                       float16       
 67  sales_roll_min_t1_7                                       float16       
 68  sales_roll_max_t1_7                                       float16       
 69  sales_roll_mean_t1_14                                     float16       
 70  sales_roll_std_t1_14                                      float16       
 71  sales_roll_min_t1_14                                      float16       
 72  sales_roll_max_t1_14                                      float16       
 73  sales_roll_mean_t1_30                                     float16       
 74  sales_roll_std_t1_30                                      float16       
 75  sales_roll_min_t1_30                                      float16       
 76  sales_roll_max_t1_30                                      float16       
 77  sales_roll_mean_t7_7                                      float16       
 78  sales_roll_std_t7_7                                       float16       
 79  sales_roll_min_t7_7                                       float16       
 80  sales_roll_max_t7_7                                       float16       
 81  sales_roll_mean_t7_14                                     float16       
 82  sales_roll_std_t7_14                                      float16       
 83  sales_roll_min_t7_14                                      float16       
 84  sales_roll_max_t7_14                                      float16       
 85  sales_roll_mean_t7_30                                     float16       
 86  sales_roll_std_t7_30                                      float16       
 87  sales_roll_min_t7_30                                      float16       
 88  sales_roll_max_t7_30                                      float16       
 89  sales_roll_mean_t14_7                                     float16       
 90  sales_roll_std_t14_7                                      float16       
 91  sales_roll_min_t14_7                                      float16       
 92  sales_roll_max_t14_7                                      float16       
 93  sales_roll_mean_t14_14                                    float16       
 94  sales_roll_std_t14_14                                     float16       
 95  sales_roll_min_t14_14                                     float16       
 96  sales_roll_max_t14_14                                     float16       
 97  sales_roll_mean_t14_30                                    float16       
 98  sales_roll_std_t14_30                                     float16       
 99  sales_roll_min_t14_30                                     float16       
 100 sales_roll_max_t14_30                                     float16       
 101 sales_rolling_ZeroRatio_t7                                float16       
 102 sales_rolling_ZeroCount_t7                                float16       
 103 sales_rolling_NonZeroRatio_t7                             float16       
 104 sales_rolling_NonZeroCount_t7                             float16       
 105 sales_rolling_ZeroRatio_t14                               float16       
 106 sales_rolling_ZeroCount_t14                               float16       
 107 sales_rolling_NonZeroRatio_t14                            float16       
 108 sales_rolling_NonZeroCount_t14                            float16       
 109 sales_rolling_ZeroRatio_t30                               float16       
 110 sales_rolling_ZeroCount_t30                               float16       
 111 sales_rolling_NonZeroRatio_t30                            float16       
 112 sales_rolling_NonZeroCount_t30                            float16       
 113 sales_rolling_skew_t30                                    float16       
 114 sales_rolling_kurt_t30                                    float16       
 115 total_sales_lag_t0                                        float16       
 116 total_sales_lag_t1                                        float16       
 117 total_sales_lag_t2                                        float16       
 118 total_sales_lag_t3                                        float16       
 119 total_sales_lag_t4                                        float16       
 120 total_sales_lag_t5                                        float16       
 121 total_sales_lag_t6                                        float16       
 122 total_sales_lag_t7                                        float16       
 123 total_sales_lag_t8                                        float16       
 124 total_sales_lag_t9                                        float16       
 125 total_sales_lag_t10                                       float16       
 126 total_sales_lag_t11                                       float16       
 127 total_sales_lag_t12                                       float16       
 128 total_sales_lag_t13                                       float16       
 129 total_sales_lag_t14                                       float16       
 130 total_sales_roll_mean_t1_7                                float16       
 131 total_sales_roll_std_t1_7                                 float16       
 132 total_sales_roll_mean_t1_14                               float16       
 133 total_sales_roll_std_t1_14                                float16       
 134 total_sales_roll_mean_t1_30                               float16       
 135 total_sales_roll_std_t1_30                                float16       
 136 total_sales_roll_mean_t7_7                                float16       
 137 total_sales_roll_std_t7_7                                 float16       
 138 total_sales_roll_mean_t7_14                               float16       
 139 total_sales_roll_std_t7_14                                float16       
 140 total_sales_roll_mean_t7_30                               float16       
 141 total_sales_roll_std_t7_30                                float16       
 142 total_sales_roll_mean_t14_7                               float16       
 143 total_sales_roll_std_t14_7                                float16       
 144 total_sales_roll_mean_t14_14                              float16       
 145 total_sales_roll_std_t14_14                               float16       
 146 total_sales_roll_mean_t14_30                              float16       
 147 total_sales_roll_std_t14_30                               float16       
 148 price_momentum                                            float16       
 149 price_momentum_m                                          float16       
 150 days_from_last_sales                                      int16         
 151 enc_sales_mean_by_state_id                                float16       
 152 enc_sales_std_by_state_id                                 float16       
 153 enc_sales_mean_by_store_id                                float16       
 154 enc_sales_std_by_store_id                                 float16       
 155 enc_sales_mean_by_cat_id                                  float16       
 156 enc_sales_std_by_cat_id                                   float16       
 157 enc_sales_mean_by_dept_id                                 float16       
 158 enc_sales_std_by_dept_id                                  float16       
 159 enc_sales_mean_by_state_id_cat_id                         float16       
 160 enc_sales_std_by_state_id_cat_id                          float16       
 161 enc_sales_mean_by_state_id_dept_id                        float16       
 162 enc_sales_std_by_state_id_dept_id                         float16       
 163 enc_sales_mean_by_store_id_cat_id                         float16       
 164 enc_sales_std_by_store_id_cat_id                          float16       
 165 enc_sales_mean_by_store_id_dept_id                        float16       
 166 enc_sales_std_by_store_id_dept_id                         float16       
 167 enc_sales_mean_by_item_id                                 float16       
 168 enc_sales_std_by_item_id                                  float16       
 169 enc_sales_mean_by_item_id_state_id                        float16       
 170 enc_sales_std_by_item_id_state_id                         float16       
 171 enc_sales_mean_by_item_id_store_id                        float16       
 172 enc_sales_std_by_item_id_store_id                         float16       
 173 enc_sales_mean_by_store_id_dayofweek                      float16       
 174 enc_sales_std_by_store_id_dayofweek                       float16       
 175 enc_sales_mean_by_dept_id_dayofweek                       float16       
 176 enc_sales_std_by_dept_id_dayofweek                        float16       
 177 enc_sales_mean_by_item_id_dayofweek                       float16       
 178 enc_sales_std_by_item_id_dayofweek                        float16       
 179 enc_sales_mean_by_store_id_dept_id_dayofweek              float16       
 180 enc_sales_std_by_store_id_dept_id_dayofweek               float16       
 181 enc_sales_mean_by_store_id_dept_id_week                   float16       
 182 enc_sales_std_by_store_id_dept_id_week                    float16       
 183 enc_sales_mean_by_store_id_dept_id_day                    float16       
 184 enc_sales_std_by_store_id_dept_id_day                     float16       
 185 enc_sales_mean_by_store_id_item_id_dayofweek              float16       
 186 enc_sales_std_by_store_id_item_id_dayofweek               float16       
 187 enc_sales_mean_by_store_id_item_id_week                   float16       
 188 enc_sales_std_by_store_id_item_id_week                    float16       
 189 enc_sales_mean_by_store_id_item_id_day                    float16       
 190 enc_sales_std_by_store_id_item_id_day                     float16       
 191 enc_sales_mean_by_store_id_item_id_nwd_CA                 float16       
 192 enc_sales_std_by_store_id_item_id_nwd_CA                  float16       
 193 enc_sales_mean_by_store_id_item_id_nwd_TX                 float16       
 194 enc_sales_std_by_store_id_item_id_nwd_TX                  float16       
 195 enc_sales_mean_by_store_id_item_id_nwd_WI                 float16       
 196 enc_sales_std_by_store_id_item_id_nwd_WI                  float16       
 197 enc_sales_mean_by_store_id_item_id_is_weekend             float16       
 198 enc_sales_std_by_store_id_item_id_is_weekend              float16       
 199 enc_sales_times_price_mean_by_state_id                    float16       
 200 enc_sales_times_price_std_by_state_id                     float16       
 201 enc_sales_times_price_mean_by_store_id                    float16       
 202 enc_sales_times_price_std_by_store_id                     float16       
 203 enc_sales_times_price_mean_by_cat_id                      float16       
 204 enc_sales_times_price_std_by_cat_id                       float16       
 205 enc_sales_times_price_mean_by_dept_id                     float16       
 206 enc_sales_times_price_std_by_dept_id                      float16       
 207 enc_sales_times_price_mean_by_state_id_cat_id             float16       
 208 enc_sales_times_price_std_by_state_id_cat_id              float16       
 209 enc_sales_times_price_mean_by_state_id_dept_id            float16       
 210 enc_sales_times_price_std_by_state_id_dept_id             float16       
 211 enc_sales_times_price_mean_by_store_id_cat_id             float16       
 212 enc_sales_times_price_std_by_store_id_cat_id              float16       
 213 enc_sales_times_price_mean_by_store_id_dept_id            float16       
 214 enc_sales_times_price_std_by_store_id_dept_id             float16       
 215 enc_sales_times_price_mean_by_item_id                     float16       
 216 enc_sales_times_price_std_by_item_id                      float16       
 217 enc_sales_times_price_mean_by_item_id_state_id            float16       
 218 enc_sales_times_price_std_by_item_id_state_id             float16       
 219 enc_sales_times_price_mean_by_item_id_store_id            float16       
 220 enc_sales_times_price_std_by_item_id_store_id             float64       
 221 enc_sales_times_price_mean_by_store_id_dayofweek          float16       
 222 enc_sales_times_price_std_by_store_id_dayofweek           float16       
 223 enc_sales_times_price_mean_by_dept_id_dayofweek           float16       
 224 enc_sales_times_price_std_by_dept_id_dayofweek            float16       
 225 enc_sales_times_price_mean_by_item_id_dayofweek           float16       
 226 enc_sales_times_price_std_by_item_id_dayofweek            float16       
 227 enc_sales_times_price_mean_by_store_id_dept_id_dayofweek  float16       
 228 enc_sales_times_price_std_by_store_id_dept_id_dayofweek   float16       
 229 enc_sales_times_price_mean_by_store_id_item_id_dayofweek  float16       
 230 enc_sales_times_price_std_by_store_id_item_id_dayofweek   float64       
 231 gte_state_id_MEAN                                         float64       
 232 gte_store_id_MEAN                                         float64       
 233 gte_cat_id_MEAN                                           float64       
 234 gte_dept_id_MEAN                                          float64       
 235 gte_item_id_MEAN                                          float64       
 236 gte_state_id_dept_id_MEAN                                 float64       
 237 gte_state_id_item_id_MEAN                                 float64       
 238 gte_store_id_dept_id_MEAN                                 float64       
 239 gte_store_id_item_id_MEAN                                 float64       
 240 gte_state_id_VAR                                          float16       
 241 gte_store_id_VAR                                          float16       
 242 gte_cat_id_VAR                                            float16       
 243 gte_dept_id_VAR                                           float16       
 244 gte_item_id_VAR                                           float16       
 245 gte_state_id_dept_id_VAR                                  float16       
 246 gte_state_id_item_id_VAR                                  float16       
 247 gte_store_id_dept_id_VAR                                  float16       
 248 gte_store_id_item_id_VAR                                  float16       
dtypes: bool(3), category(9), datetime64[ns](1), float16(199), float64(11), int16(5), int8(20), object(1)
memory usage: 12.2+ GB
None 

Dump Train Data.
1/7, Dump pickle to features/train_data_FOODS_1.pkl.
2/7, Dump pickle to features/train_data_FOODS_2.pkl.
3/7, Dump pickle to features/train_data_FOODS_3.pkl.
4/7, Dump pickle to features/train_data_HOBBIES_1.pkl.
5/7, Dump pickle to features/train_data_HOBBIES_2.pkl.
6/7, Dump pickle to features/train_data_HOUSEHOLD_1.pkl.
7/7, Dump pickle to features/train_data_HOUSEHOLD_2.pkl.
Dump Evaluation Data.
Dump pickle to features/eval_data.pkl.
Dump Submisssion Data.
Split submit_data to features/submit_data.pkl
Dump pickle to features/submit_data.pkl.


--- Define Evaluator ---


Dump pickle to features/evaluator.pkl.
#########################
##### Fold 1 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 42,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('FOODS_1',), 1/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0528544
[200]	valid_0's WRMSSE: 0.052392
Early stopping, best iteration is:
[150]	valid_0's WRMSSE: 0.0523546


Group ID: ('FOODS_2',), 2/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.136358
[200]	valid_0's WRMSSE: 0.13384
[300]	valid_0's WRMSSE: 0.133305
[400]	valid_0's WRMSSE: 0.133342
Early stopping, best iteration is:
[307]	valid_0's WRMSSE: 0.133245


Group ID: ('FOODS_3',), 3/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.298614
[200]	valid_0's WRMSSE: 0.293612
[300]	valid_0's WRMSSE: 0.292129
[400]	valid_0's WRMSSE: 0.291991
[500]	valid_0's WRMSSE: 0.291659
[600]	valid_0's WRMSSE: 0.291591
Early stopping, best iteration is:
[534]	valid_0's WRMSSE: 0.291541


Group ID: ('HOBBIES_1',), 4/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0968907
[200]	valid_0's WRMSSE: 0.0963281
[300]	valid_0's WRMSSE: 0.0960575
[400]	valid_0's WRMSSE: 0.0959518
Early stopping, best iteration is:
[382]	valid_0's WRMSSE: 0.0959356


Group ID: ('HOBBIES_2',), 5/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.00496567
[200]	valid_0's WRMSSE: 0.00493463
[300]	valid_0's WRMSSE: 0.00493293
[400]	valid_0's WRMSSE: 0.00493589
Early stopping, best iteration is:
[324]	valid_0's WRMSSE: 0.00493146


Group ID: ('HOUSEHOLD_1',), 6/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.213936
[200]	valid_0's WRMSSE: 0.198408
[300]	valid_0's WRMSSE: 0.19512
[400]	valid_0's WRMSSE: 0.193842
[500]	valid_0's WRMSSE: 0.193245
[600]	valid_0's WRMSSE: 0.19287
[700]	valid_0's WRMSSE: 0.192815
[800]	valid_0's WRMSSE: 0.192706
[900]	valid_0's WRMSSE: 0.19271
[1000]	valid_0's WRMSSE: 0.192677
Early stopping, best iteration is:
[987]	valid_0's WRMSSE: 0.192637


Group ID: ('HOUSEHOLD_2',), 7/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0628132
[200]	valid_0's WRMSSE: 0.0606113
[300]	valid_0's WRMSSE: 0.0599549
[400]	valid_0's WRMSSE: 0.0596637
[500]	valid_0's WRMSSE: 0.0594927
[600]	valid_0's WRMSSE: 0.0593808
[700]	valid_0's WRMSSE: 0.059323
[800]	valid_0's WRMSSE: 0.0592876
[900]	valid_0's WRMSSE: 0.0592579
[1000]	valid_0's WRMSSE: 0.0592372
[1100]	valid_0's WRMSSE: 0.0592184
[1200]	valid_0's WRMSSE: 0.0591931
[1300]	valid_0's WRMSSE: 0.0591866
[1400]	valid_0's WRMSSE: 0.0591811
Early stopping, best iteration is:
[1323]	valid_0's WRMSSE: 0.0591797

Dump pickle to result/model/v08004.pkl.


--- Evaluation ---


Load pickle from result/model/v08004.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08004.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.0837878351657517
Our val WRMSSE score is 0.521622366126163


--- Submission ---


Load pickle from result/model/v08004.pkl.
Load pickle from result/feature_cols/v08004.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.718565  0.915491  0.996124  1.192438   
1  HOBBIES_1_002_CA_1_validation  0.169060  0.145668  0.189802  0.241442   
2  HOBBIES_1_003_CA_1_validation  0.228462  0.360279  0.413314  0.355449   
3  HOBBIES_1_004_CA_1_validation  1.452326  1.477657  1.447626  1.543440   
4  HOBBIES_1_005_CA_1_validation  0.915390  0.679669  0.972045  0.867319   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.887488  1.532347  1.743085  0.540059  0.573163  0.625841  0.441330   
1  0.219865  0.243848  0.247816  0.273005  0.436278  0.383569  0.301446   
2  0.472685  0.562661  0.553041  0.270189  0.305678  0.232248  0.484418   
3  1.858614  2.332778  3.336445  1.676786  1.482428  1.427148  1.678465   
4  0.968227  1.176685  1.307350  1.230933  1.116941  1.002665  0.941996   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.597688  1.079429  0.615446  0.823794  0.603619  0.612657  0.755634   
1  0.424473  0.360160  0.400912  0.216108  0.277365  0.272365  0.250336   
2  0.321224  0.897684  0.574581  0.322151  0.430300  0.394132  0.450900   
3  1.943067  3.141343  3.126286  1.390543  1.113392  1.231648  1.313263   
4  1.112533  1.793738  1.532417  0.730601  0.780177  0.829487  0.820248   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.691233  1.422691  0.722688  0.606734  0.552263  0.452089  0.627419   
1  0.189259  0.408433  0.376376  0.240668  0.255362  0.216361  0.335655   
2  0.688149  0.696486  0.652831  0.420108  0.306606  0.411775  0.698638   
3  1.304676  2.171351  2.172149  1.873265  1.447414  1.512350  1.385060   
4  0.867317  1.120833  1.101842  1.267690  1.106946  1.396339  1.404822   

        F26       F27       F28  
0  0.721037  0.723369  0.808813  
1  0.285475  0.352049  0.363791  
2  0.683517  0.587417  0.795324  
3  2.072246  2.684875  4.268037  
4  1.613361  2.528871  2.252365  
#########################
##### Fold 2 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 43,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('FOODS_1',), 1/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0527778
[200]	valid_0's WRMSSE: 0.0527628
Early stopping, best iteration is:
[150]	valid_0's WRMSSE: 0.052594


Group ID: ('FOODS_2',), 2/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.135723
[200]	valid_0's WRMSSE: 0.133528
[300]	valid_0's WRMSSE: 0.133102
[400]	valid_0's WRMSSE: 0.133
[500]	valid_0's WRMSSE: 0.133039
Early stopping, best iteration is:
[425]	valid_0's WRMSSE: 0.132951


Group ID: ('FOODS_3',), 3/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.299338
[200]	valid_0's WRMSSE: 0.293795
[300]	valid_0's WRMSSE: 0.292153
[400]	valid_0's WRMSSE: 0.292021
Early stopping, best iteration is:
[373]	valid_0's WRMSSE: 0.291842


Group ID: ('HOBBIES_1',), 4/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0969869
[200]	valid_0's WRMSSE: 0.0963506
[300]	valid_0's WRMSSE: 0.0960672
[400]	valid_0's WRMSSE: 0.095907
[500]	valid_0's WRMSSE: 0.0958347
[600]	valid_0's WRMSSE: 0.0958311
[700]	valid_0's WRMSSE: 0.0957959
Early stopping, best iteration is:
[695]	valid_0's WRMSSE: 0.0957896


Group ID: ('HOBBIES_2',), 5/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.00496885
[200]	valid_0's WRMSSE: 0.00494063
[300]	valid_0's WRMSSE: 0.00494048
[400]	valid_0's WRMSSE: 0.00494049
Early stopping, best iteration is:
[325]	valid_0's WRMSSE: 0.00493784


Group ID: ('HOUSEHOLD_1',), 6/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.214024
[200]	valid_0's WRMSSE: 0.198618
[300]	valid_0's WRMSSE: 0.195333
[400]	valid_0's WRMSSE: 0.194087
[500]	valid_0's WRMSSE: 0.193496
[600]	valid_0's WRMSSE: 0.193159
[700]	valid_0's WRMSSE: 0.192918
[800]	valid_0's WRMSSE: 0.192789
[900]	valid_0's WRMSSE: 0.192794
Early stopping, best iteration is:
[824]	valid_0's WRMSSE: 0.192746


Group ID: ('HOUSEHOLD_2',), 7/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0628361
[200]	valid_0's WRMSSE: 0.0606312
[300]	valid_0's WRMSSE: 0.0600083
[400]	valid_0's WRMSSE: 0.0597162
[500]	valid_0's WRMSSE: 0.0595282
[600]	valid_0's WRMSSE: 0.0594176
[700]	valid_0's WRMSSE: 0.059347
[800]	valid_0's WRMSSE: 0.0593049
[900]	valid_0's WRMSSE: 0.0592606
[1000]	valid_0's WRMSSE: 0.0592191
[1100]	valid_0's WRMSSE: 0.0592019
[1200]	valid_0's WRMSSE: 0.0591876
[1300]	valid_0's WRMSSE: 0.0591823
[1400]	valid_0's WRMSSE: 0.0591822
[1500]	valid_0's WRMSSE: 0.0591773
Did not meet early stopping. Best iteration is:
[1465]	valid_0's WRMSSE: 0.0591706

Dump pickle to result/model/v08004.pkl.


--- Evaluation ---


Load pickle from result/model/v08004.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08004.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.086235468220637
Our val WRMSSE score is 0.5324285752393408


--- Submission ---


Load pickle from result/model/v08004.pkl.
Load pickle from result/feature_cols/v08004.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.657213  0.946707  0.908206  1.356804   
1  HOBBIES_1_002_CA_1_validation  0.155381  0.126702  0.173390  0.223150   
2  HOBBIES_1_003_CA_1_validation  0.221874  0.354594  0.399929  0.340118   
3  HOBBIES_1_004_CA_1_validation  1.309834  1.403520  1.401290  1.517057   
4  HOBBIES_1_005_CA_1_validation  0.917609  0.686853  0.975772  0.858180   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.909575  1.847595  1.940392  0.545858  0.609211  0.649030  0.412042   
1  0.216782  0.278810  0.279057  0.286087  0.465123  0.391254  0.329747   
2  0.472762  0.511662  0.526110  0.256607  0.289229  0.215536  0.411332   
3  1.682527  2.170929  3.474680  1.465615  1.327274  1.228491  1.709150   
4  0.908658  1.239109  1.364859  1.224431  1.049100  0.924685  0.947541   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.614581  1.147658  0.692020  0.861861  0.613821  0.604213  0.813839   
1  0.465173  0.372277  0.369048  0.218423  0.266848  0.272796  0.256526   
2  0.324399  0.921681  0.584566  0.332486  0.428164  0.371099  0.424467   
3  2.049977  2.927919  2.680992  1.345579  1.062269  1.156235  1.216470   
4  0.998899  1.783644  1.351735  0.694788  0.740156  0.781958  0.784039   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.681824  1.593364  0.707813  0.639661  0.590250  0.482073  0.715363   
1  0.188693  0.431512  0.386291  0.239152  0.243745  0.208490  0.364276   
2  0.712676  0.646835  0.650083  0.392650  0.293035  0.404864  0.754653   
3  1.217026  2.177523  1.930876  1.719104  1.332809  1.367458  1.180606   
4  0.789040  1.064816  1.001459  1.188429  0.953742  1.462141  1.368763   

        F26       F27       F28  
0  0.769411  0.767414  0.841855  
1  0.293063  0.369676  0.372779  
2  0.709521  0.505725  0.829376  
3  1.920774  2.654153  3.690983  
4  1.366110  2.625069  2.132891  
#########################
##### Fold 3 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 45,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('FOODS_1',), 1/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0530555
[200]	valid_0's WRMSSE: 0.052652
Early stopping, best iteration is:
[176]	valid_0's WRMSSE: 0.0525772


Group ID: ('FOODS_2',), 2/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.136683
[200]	valid_0's WRMSSE: 0.134442
[300]	valid_0's WRMSSE: 0.133862
[400]	valid_0's WRMSSE: 0.133777
Early stopping, best iteration is:
[396]	valid_0's WRMSSE: 0.133752


Group ID: ('FOODS_3',), 3/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.299332
[200]	valid_0's WRMSSE: 0.293584
[300]	valid_0's WRMSSE: 0.292024
[400]	valid_0's WRMSSE: 0.291676
[500]	valid_0's WRMSSE: 0.291613
Early stopping, best iteration is:
[490]	valid_0's WRMSSE: 0.291465


Group ID: ('HOBBIES_1',), 4/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0973329
[200]	valid_0's WRMSSE: 0.0968001
[300]	valid_0's WRMSSE: 0.0965421
[400]	valid_0's WRMSSE: 0.0964733
[500]	valid_0's WRMSSE: 0.0963895
[600]	valid_0's WRMSSE: 0.0963184
[700]	valid_0's WRMSSE: 0.0963238
Early stopping, best iteration is:
[670]	valid_0's WRMSSE: 0.0963081


Group ID: ('HOBBIES_2',), 5/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.00495121
[200]	valid_0's WRMSSE: 0.0049293
Early stopping, best iteration is:
[197]	valid_0's WRMSSE: 0.0049291


Group ID: ('HOUSEHOLD_1',), 6/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.213891
[200]	valid_0's WRMSSE: 0.198513
[300]	valid_0's WRMSSE: 0.195246
[400]	valid_0's WRMSSE: 0.194006
[500]	valid_0's WRMSSE: 0.193456
[600]	valid_0's WRMSSE: 0.19315
[700]	valid_0's WRMSSE: 0.192938
[800]	valid_0's WRMSSE: 0.192842
[900]	valid_0's WRMSSE: 0.192732
[1000]	valid_0's WRMSSE: 0.192762
Early stopping, best iteration is:
[945]	valid_0's WRMSSE: 0.19268


Group ID: ('HOUSEHOLD_2',), 7/7
Dump pickle to result/feature_cols/v08004.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0628121
[200]	valid_0's WRMSSE: 0.0606309
[300]	valid_0's WRMSSE: 0.0599905
[400]	valid_0's WRMSSE: 0.0596903
[500]	valid_0's WRMSSE: 0.0595274
[600]	valid_0's WRMSSE: 0.0594235
[700]	valid_0's WRMSSE: 0.0593601
[800]	valid_0's WRMSSE: 0.0592976
[900]	valid_0's WRMSSE: 0.0592608
[1000]	valid_0's WRMSSE: 0.0592308
[1100]	valid_0's WRMSSE: 0.0592303
[1200]	valid_0's WRMSSE: 0.0592149
[1300]	valid_0's WRMSSE: 0.0592068
[1400]	valid_0's WRMSSE: 0.0592069
Early stopping, best iteration is:
[1323]	valid_0's WRMSSE: 0.059203

Dump pickle to result/model/v08004.pkl.


--- Evaluation ---


Load pickle from result/model/v08004.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08004.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.0912118197915825
Our val WRMSSE score is 0.5280219242590476


--- Submission ---


Load pickle from result/model/v08004.pkl.
Load pickle from result/feature_cols/v08004.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.733045  0.892872  0.883007  1.225345   
1  HOBBIES_1_002_CA_1_validation  0.153074  0.125563  0.164906  0.216257   
2  HOBBIES_1_003_CA_1_validation  0.232964  0.363903  0.405966  0.369392   
3  HOBBIES_1_004_CA_1_validation  1.382527  1.364160  1.344553  1.486590   
4  HOBBIES_1_005_CA_1_validation  0.861498  0.682494  0.910312  0.808923   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.915405  1.725578  1.781722  0.556594  0.619323  0.617506  0.427924   
1  0.196089  0.243229  0.263159  0.282484  0.437910  0.387716  0.334908   
2  0.477604  0.563873  0.587369  0.273726  0.291635  0.227491  0.496013   
3  1.733314  2.559854  3.630753  1.587286  1.376871  1.245119  1.843172   
4  0.913869  1.092503  1.399147  1.274516  1.046315  0.944390  1.048005   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.600956  1.076225  0.673388  0.843767  0.648843  0.598314  0.700471   
1  0.433156  0.362045  0.374730  0.219088  0.282250  0.269458  0.258131   
2  0.352336  0.888413  0.643866  0.326368  0.395324  0.385898  0.455557   
3  1.922604  3.178956  2.783174  1.346220  0.996179  1.079668  1.237094   
4  1.076461  1.851986  1.454773  0.706618  0.695875  0.741736  0.746461   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.683532  1.423967  0.680620  0.573922  0.576155  0.431837  0.652204   
1  0.183915  0.434927  0.385385  0.240839  0.249669  0.214748  0.338077   
2  0.745626  0.676344  0.678134  0.381499  0.297243  0.415808  0.704187   
3  1.205851  2.443926  2.197549  1.808656  1.393442  1.410457  1.311739   
4  0.816131  1.100175  1.057404  1.139710  0.987754  1.316939  1.321700   

        F26       F27       F28  
0  0.727512  0.754635  0.806607  
1  0.287256  0.369446  0.361860  
2  0.713531  0.540589  0.819906  
3  1.962056  2.895454  3.791443  
4  1.535488  2.702975  2.213768  
