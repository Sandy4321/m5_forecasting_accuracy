

--- Transform ---


Load pickle from features/parse_calendar.pkl.
Load pickle from features/parse_sell_prices.pkl.
Load pickle from features/parse_sales_train.pkl.
Load pickle from features/melted_and_merged_train.pkl.


--- Create Features ---


Load pickle from features/sales_lag_and_roll.pkl.
Load pickle from features/total_sales_lag_and_roll.pkl.
Load pickle from features/price_simple_feature.pkl.
Load pickle from features/days_from_last_sales.pkl.
Load pickle from features/simple_target_encoding.pkl.
Load pickle from features/simple_total_sales_encoding.pkl.
Load pickle from features/hierarchical_bayesian_target_encoding.pkl.
Dump pickle to features/all_data.pkl.


--- Split Data ---


<class 'pandas.core.frame.DataFrame'>
RangeIndex: 12836290 entries, 47198520 to 60034809
Data columns (total 249 columns):
 #   Column                                                    Dtype         
---  ------                                                    -----         
 0   id                                                        object        
 1   item_id                                                   category      
 2   dept_id                                                   category      
 3   cat_id                                                    category      
 4   store_id                                                  category      
 5   state_id                                                  category      
 6   d                                                         int16         
 7   sales                                                     float16       
 8   date                                                      datetime64[ns]
 9   wm_yr_wk                                                  int16         
 10  event_name_1                                              category      
 11  event_type_1                                              category      
 12  event_name_2                                              category      
 13  event_type_2                                              category      
 14  snap_CA                                                   int8          
 15  snap_TX                                                   int8          
 16  snap_WI                                                   int8          
 17  year                                                      int16         
 18  quarter                                                   int8          
 19  month                                                     int8          
 20  week                                                      int8          
 21  day                                                       int8          
 22  dayofweek                                                 int8          
 23  dayofyear                                                 int16         
 24  is_month_end                                              bool          
 25  is_month_start                                            bool          
 26  is_weekend                                                bool          
 27  nwd_CA                                                    int8          
 28  nwd_TX                                                    int8          
 29  nwd_WI                                                    int8          
 30  nwd_CA_rolling_t7                                         int8          
 31  nwd_CA_rolling_t14                                        int8          
 32  nwd_CA_rolling_t28                                        int8          
 33  nwd_TX_rolling_t7                                         int8          
 34  nwd_TX_rolling_t14                                        int8          
 35  nwd_TX_rolling_t28                                        int8          
 36  nwd_WI_rolling_t7                                         int8          
 37  nwd_WI_rolling_t14                                        int8          
 38  nwd_WI_rolling_t28                                        int8          
 39  sell_price                                                float16       
 40  price_max                                                 float16       
 41  price_min                                                 float16       
 42  price_std                                                 float16       
 43  price_mean                                                float16       
 44  price_nunique                                             float16       
 45  release                                                   float16       
 46  id_nunique_by_price                                       float16       
 47  price_float                                               float16       
 48  price_int                                                 float16       
 49  price_norm                                                float16       
 50  sales_lag_t0                                              float16       
 51  sales_lag_t1                                              float16       
 52  sales_lag_t2                                              float16       
 53  sales_lag_t3                                              float16       
 54  sales_lag_t4                                              float16       
 55  sales_lag_t5                                              float16       
 56  sales_lag_t6                                              float16       
 57  sales_lag_t7                                              float16       
 58  sales_lag_t8                                              float16       
 59  sales_lag_t9                                              float16       
 60  sales_lag_t10                                             float16       
 61  sales_lag_t11                                             float16       
 62  sales_lag_t12                                             float16       
 63  sales_lag_t13                                             float16       
 64  sales_lag_t14                                             float16       
 65  sales_roll_mean_t1_7                                      float16       
 66  sales_roll_std_t1_7                                       float16       
 67  sales_roll_min_t1_7                                       float16       
 68  sales_roll_max_t1_7                                       float16       
 69  sales_roll_mean_t1_14                                     float16       
 70  sales_roll_std_t1_14                                      float16       
 71  sales_roll_min_t1_14                                      float16       
 72  sales_roll_max_t1_14                                      float16       
 73  sales_roll_mean_t1_30                                     float16       
 74  sales_roll_std_t1_30                                      float16       
 75  sales_roll_min_t1_30                                      float16       
 76  sales_roll_max_t1_30                                      float16       
 77  sales_roll_mean_t7_7                                      float16       
 78  sales_roll_std_t7_7                                       float16       
 79  sales_roll_min_t7_7                                       float16       
 80  sales_roll_max_t7_7                                       float16       
 81  sales_roll_mean_t7_14                                     float16       
 82  sales_roll_std_t7_14                                      float16       
 83  sales_roll_min_t7_14                                      float16       
 84  sales_roll_max_t7_14                                      float16       
 85  sales_roll_mean_t7_30                                     float16       
 86  sales_roll_std_t7_30                                      float16       
 87  sales_roll_min_t7_30                                      float16       
 88  sales_roll_max_t7_30                                      float16       
 89  sales_roll_mean_t14_7                                     float16       
 90  sales_roll_std_t14_7                                      float16       
 91  sales_roll_min_t14_7                                      float16       
 92  sales_roll_max_t14_7                                      float16       
 93  sales_roll_mean_t14_14                                    float16       
 94  sales_roll_std_t14_14                                     float16       
 95  sales_roll_min_t14_14                                     float16       
 96  sales_roll_max_t14_14                                     float16       
 97  sales_roll_mean_t14_30                                    float16       
 98  sales_roll_std_t14_30                                     float16       
 99  sales_roll_min_t14_30                                     float16       
 100 sales_roll_max_t14_30                                     float16       
 101 sales_rolling_ZeroRatio_t7                                float16       
 102 sales_rolling_ZeroCount_t7                                float16       
 103 sales_rolling_NonZeroRatio_t7                             float16       
 104 sales_rolling_NonZeroCount_t7                             float16       
 105 sales_rolling_ZeroRatio_t14                               float16       
 106 sales_rolling_ZeroCount_t14                               float16       
 107 sales_rolling_NonZeroRatio_t14                            float16       
 108 sales_rolling_NonZeroCount_t14                            float16       
 109 sales_rolling_ZeroRatio_t30                               float16       
 110 sales_rolling_ZeroCount_t30                               float16       
 111 sales_rolling_NonZeroRatio_t30                            float16       
 112 sales_rolling_NonZeroCount_t30                            float16       
 113 sales_rolling_skew_t30                                    float16       
 114 sales_rolling_kurt_t30                                    float16       
 115 total_sales_lag_t0                                        float16       
 116 total_sales_lag_t1                                        float16       
 117 total_sales_lag_t2                                        float16       
 118 total_sales_lag_t3                                        float16       
 119 total_sales_lag_t4                                        float16       
 120 total_sales_lag_t5                                        float16       
 121 total_sales_lag_t6                                        float16       
 122 total_sales_lag_t7                                        float16       
 123 total_sales_lag_t8                                        float16       
 124 total_sales_lag_t9                                        float16       
 125 total_sales_lag_t10                                       float16       
 126 total_sales_lag_t11                                       float16       
 127 total_sales_lag_t12                                       float16       
 128 total_sales_lag_t13                                       float16       
 129 total_sales_lag_t14                                       float16       
 130 total_sales_roll_mean_t1_7                                float16       
 131 total_sales_roll_std_t1_7                                 float16       
 132 total_sales_roll_mean_t1_14                               float16       
 133 total_sales_roll_std_t1_14                                float16       
 134 total_sales_roll_mean_t1_30                               float16       
 135 total_sales_roll_std_t1_30                                float16       
 136 total_sales_roll_mean_t7_7                                float16       
 137 total_sales_roll_std_t7_7                                 float16       
 138 total_sales_roll_mean_t7_14                               float16       
 139 total_sales_roll_std_t7_14                                float16       
 140 total_sales_roll_mean_t7_30                               float16       
 141 total_sales_roll_std_t7_30                                float16       
 142 total_sales_roll_mean_t14_7                               float16       
 143 total_sales_roll_std_t14_7                                float16       
 144 total_sales_roll_mean_t14_14                              float16       
 145 total_sales_roll_std_t14_14                               float16       
 146 total_sales_roll_mean_t14_30                              float16       
 147 total_sales_roll_std_t14_30                               float16       
 148 price_momentum                                            float16       
 149 price_momentum_m                                          float16       
 150 days_from_last_sales                                      int16         
 151 enc_sales_mean_by_state_id                                float16       
 152 enc_sales_std_by_state_id                                 float16       
 153 enc_sales_mean_by_store_id                                float16       
 154 enc_sales_std_by_store_id                                 float16       
 155 enc_sales_mean_by_cat_id                                  float16       
 156 enc_sales_std_by_cat_id                                   float16       
 157 enc_sales_mean_by_dept_id                                 float16       
 158 enc_sales_std_by_dept_id                                  float16       
 159 enc_sales_mean_by_state_id_cat_id                         float16       
 160 enc_sales_std_by_state_id_cat_id                          float16       
 161 enc_sales_mean_by_state_id_dept_id                        float16       
 162 enc_sales_std_by_state_id_dept_id                         float16       
 163 enc_sales_mean_by_store_id_cat_id                         float16       
 164 enc_sales_std_by_store_id_cat_id                          float16       
 165 enc_sales_mean_by_store_id_dept_id                        float16       
 166 enc_sales_std_by_store_id_dept_id                         float16       
 167 enc_sales_mean_by_item_id                                 float16       
 168 enc_sales_std_by_item_id                                  float16       
 169 enc_sales_mean_by_item_id_state_id                        float16       
 170 enc_sales_std_by_item_id_state_id                         float16       
 171 enc_sales_mean_by_item_id_store_id                        float16       
 172 enc_sales_std_by_item_id_store_id                         float16       
 173 enc_sales_mean_by_store_id_dayofweek                      float16       
 174 enc_sales_std_by_store_id_dayofweek                       float16       
 175 enc_sales_mean_by_dept_id_dayofweek                       float16       
 176 enc_sales_std_by_dept_id_dayofweek                        float16       
 177 enc_sales_mean_by_item_id_dayofweek                       float16       
 178 enc_sales_std_by_item_id_dayofweek                        float16       
 179 enc_sales_mean_by_store_id_dept_id_dayofweek              float16       
 180 enc_sales_std_by_store_id_dept_id_dayofweek               float16       
 181 enc_sales_mean_by_store_id_dept_id_week                   float16       
 182 enc_sales_std_by_store_id_dept_id_week                    float16       
 183 enc_sales_mean_by_store_id_dept_id_day                    float16       
 184 enc_sales_std_by_store_id_dept_id_day                     float16       
 185 enc_sales_mean_by_store_id_item_id_dayofweek              float16       
 186 enc_sales_std_by_store_id_item_id_dayofweek               float16       
 187 enc_sales_mean_by_store_id_item_id_week                   float16       
 188 enc_sales_std_by_store_id_item_id_week                    float16       
 189 enc_sales_mean_by_store_id_item_id_day                    float16       
 190 enc_sales_std_by_store_id_item_id_day                     float16       
 191 enc_sales_mean_by_store_id_item_id_nwd_CA                 float16       
 192 enc_sales_std_by_store_id_item_id_nwd_CA                  float16       
 193 enc_sales_mean_by_store_id_item_id_nwd_TX                 float16       
 194 enc_sales_std_by_store_id_item_id_nwd_TX                  float16       
 195 enc_sales_mean_by_store_id_item_id_nwd_WI                 float16       
 196 enc_sales_std_by_store_id_item_id_nwd_WI                  float16       
 197 enc_sales_mean_by_store_id_item_id_is_weekend             float16       
 198 enc_sales_std_by_store_id_item_id_is_weekend              float16       
 199 enc_sales_times_price_mean_by_state_id                    float16       
 200 enc_sales_times_price_std_by_state_id                     float16       
 201 enc_sales_times_price_mean_by_store_id                    float16       
 202 enc_sales_times_price_std_by_store_id                     float16       
 203 enc_sales_times_price_mean_by_cat_id                      float16       
 204 enc_sales_times_price_std_by_cat_id                       float16       
 205 enc_sales_times_price_mean_by_dept_id                     float16       
 206 enc_sales_times_price_std_by_dept_id                      float16       
 207 enc_sales_times_price_mean_by_state_id_cat_id             float16       
 208 enc_sales_times_price_std_by_state_id_cat_id              float16       
 209 enc_sales_times_price_mean_by_state_id_dept_id            float16       
 210 enc_sales_times_price_std_by_state_id_dept_id             float16       
 211 enc_sales_times_price_mean_by_store_id_cat_id             float16       
 212 enc_sales_times_price_std_by_store_id_cat_id              float16       
 213 enc_sales_times_price_mean_by_store_id_dept_id            float16       
 214 enc_sales_times_price_std_by_store_id_dept_id             float16       
 215 enc_sales_times_price_mean_by_item_id                     float16       
 216 enc_sales_times_price_std_by_item_id                      float16       
 217 enc_sales_times_price_mean_by_item_id_state_id            float16       
 218 enc_sales_times_price_std_by_item_id_state_id             float16       
 219 enc_sales_times_price_mean_by_item_id_store_id            float16       
 220 enc_sales_times_price_std_by_item_id_store_id             float64       
 221 enc_sales_times_price_mean_by_store_id_dayofweek          float16       
 222 enc_sales_times_price_std_by_store_id_dayofweek           float16       
 223 enc_sales_times_price_mean_by_dept_id_dayofweek           float16       
 224 enc_sales_times_price_std_by_dept_id_dayofweek            float16       
 225 enc_sales_times_price_mean_by_item_id_dayofweek           float16       
 226 enc_sales_times_price_std_by_item_id_dayofweek            float16       
 227 enc_sales_times_price_mean_by_store_id_dept_id_dayofweek  float16       
 228 enc_sales_times_price_std_by_store_id_dept_id_dayofweek   float16       
 229 enc_sales_times_price_mean_by_store_id_item_id_dayofweek  float16       
 230 enc_sales_times_price_std_by_store_id_item_id_dayofweek   float64       
 231 gte_state_id_MEAN                                         float64       
 232 gte_store_id_MEAN                                         float64       
 233 gte_cat_id_MEAN                                           float64       
 234 gte_dept_id_MEAN                                          float64       
 235 gte_item_id_MEAN                                          float64       
 236 gte_state_id_dept_id_MEAN                                 float64       
 237 gte_state_id_item_id_MEAN                                 float64       
 238 gte_store_id_dept_id_MEAN                                 float64       
 239 gte_store_id_item_id_MEAN                                 float64       
 240 gte_state_id_VAR                                          float16       
 241 gte_store_id_VAR                                          float16       
 242 gte_cat_id_VAR                                            float16       
 243 gte_dept_id_VAR                                           float16       
 244 gte_item_id_VAR                                           float16       
 245 gte_state_id_dept_id_VAR                                  float16       
 246 gte_state_id_item_id_VAR                                  float16       
 247 gte_store_id_dept_id_VAR                                  float16       
 248 gte_store_id_item_id_VAR                                  float16       
dtypes: bool(3), category(9), datetime64[ns](1), float16(199), float64(11), int16(5), int8(20), object(1)
memory usage: 6.5+ GB
None 

Dump Train Data.
1/7, Dump pickle to features/train_data_FOODS_1.pkl.
2/7, Dump pickle to features/train_data_FOODS_2.pkl.
3/7, Dump pickle to features/train_data_FOODS_3.pkl.
4/7, Dump pickle to features/train_data_HOBBIES_1.pkl.
5/7, Dump pickle to features/train_data_HOBBIES_2.pkl.
6/7, Dump pickle to features/train_data_HOUSEHOLD_1.pkl.
7/7, Dump pickle to features/train_data_HOUSEHOLD_2.pkl.
Dump Evaluation Data.
Dump pickle to features/eval_data.pkl.
Dump Submisssion Data.
Split submit_data to features/submit_data.pkl
Dump pickle to features/submit_data.pkl.


--- Define Evaluator ---


Dump pickle to features/evaluator.pkl.
#########################
##### Fold 1 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 42,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('FOODS_1',), 1/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0530183
[200]	valid_0's WRMSSE: 0.0526663
[300]	valid_0's WRMSSE: 0.0526041
Early stopping, best iteration is:
[271]	valid_0's WRMSSE: 0.0525633


Group ID: ('FOODS_2',), 2/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.135993
[200]	valid_0's WRMSSE: 0.134263
[300]	valid_0's WRMSSE: 0.134006
[400]	valid_0's WRMSSE: 0.133936
Early stopping, best iteration is:
[382]	valid_0's WRMSSE: 0.133861


Group ID: ('FOODS_3',), 3/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.296041
[200]	valid_0's WRMSSE: 0.29085
[300]	valid_0's WRMSSE: 0.289475
[400]	valid_0's WRMSSE: 0.288924
[500]	valid_0's WRMSSE: 0.288771
[600]	valid_0's WRMSSE: 0.288746
Early stopping, best iteration is:
[527]	valid_0's WRMSSE: 0.288699


Group ID: ('HOBBIES_1',), 4/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.096144
[200]	valid_0's WRMSSE: 0.0955101
[300]	valid_0's WRMSSE: 0.095517
Early stopping, best iteration is:
[271]	valid_0's WRMSSE: 0.0954719


Group ID: ('HOBBIES_2',), 5/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.00496466
[200]	valid_0's WRMSSE: 0.00495059
Early stopping, best iteration is:
[189]	valid_0's WRMSSE: 0.00494772


Group ID: ('HOUSEHOLD_1',), 6/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.213647
[200]	valid_0's WRMSSE: 0.197243
[300]	valid_0's WRMSSE: 0.194019
[400]	valid_0's WRMSSE: 0.192995
[500]	valid_0's WRMSSE: 0.192563
[600]	valid_0's WRMSSE: 0.192468
[700]	valid_0's WRMSSE: 0.192603
Early stopping, best iteration is:
[623]	valid_0's WRMSSE: 0.192395


Group ID: ('HOUSEHOLD_2',), 7/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0629205
[200]	valid_0's WRMSSE: 0.0606468
[300]	valid_0's WRMSSE: 0.0600432
[400]	valid_0's WRMSSE: 0.0597781
[500]	valid_0's WRMSSE: 0.0596639
[600]	valid_0's WRMSSE: 0.0595918
[700]	valid_0's WRMSSE: 0.0595556
[800]	valid_0's WRMSSE: 0.0595315
[900]	valid_0's WRMSSE: 0.059509
[1000]	valid_0's WRMSSE: 0.059499
[1100]	valid_0's WRMSSE: 0.0595064
Early stopping, best iteration is:
[1065]	valid_0's WRMSSE: 0.0594972

Dump pickle to result/model/v08003.pkl.


--- Evaluation ---


Load pickle from result/model/v08003.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08003.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.092374131126163
Our val WRMSSE score is 0.6042556472495402


--- Submission ---


Load pickle from result/model/v08003.pkl.
Load pickle from result/feature_cols/v08003.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.756005  0.937210  1.016130  1.201882   
1  HOBBIES_1_002_CA_1_validation  0.160146  0.134507  0.172374  0.219125   
2  HOBBIES_1_003_CA_1_validation  0.280489  0.380674  0.472877  0.391934   
3  HOBBIES_1_004_CA_1_validation  1.416862  1.236173  1.260652  1.515733   
4  HOBBIES_1_005_CA_1_validation  0.978565  0.817310  1.013022  0.966442   

         F5        F6        F7        F8        F9       F10       F11  \
0  1.009095  1.596396  1.903025  0.554372  0.614178  0.655301  0.451890   
1  0.195338  0.214075  0.241505  0.261763  0.391644  0.344630  0.269146   
2  0.472069  0.583932  0.623076  0.349572  0.358170  0.288235  0.480862   
3  1.650569  2.084867  2.744279  1.747590  1.591874  1.521222  1.812176   
4  0.999019  1.214833  1.266379  1.277927  1.061601  0.997730  1.054465   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.647821  0.993043  0.587794  0.812697  0.635121  0.670950  0.783788   
1  0.397553  0.334481  0.337884  0.219469  0.268958  0.260182  0.248497   
2  0.390898  0.898725  0.573319  0.430164  0.521111  0.490456  0.519507   
3  1.994689  2.750660  2.683641  1.362768  1.113900  1.134888  1.215120   
4  1.034376  1.725170  1.308673  0.793000  0.775756  0.830712  0.848685   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.717435  1.370226  0.705881  0.660142  0.601309  0.477683  0.684992   
1  0.184088  0.380747  0.359729  0.239996  0.240352  0.210831  0.319316   
2  0.761446  0.717680  0.718383  0.489904  0.365899  0.517196  0.726007   
3  1.197281  1.806387  1.752814  1.849329  1.434958  1.509501  1.532473   
4  0.831219  1.088574  1.087161  1.215767  1.006941  1.229781  1.285206   

        F26       F27       F28  
0  0.740755  0.710636  0.822848  
1  0.286824  0.348779  0.364195  
2  0.714227  0.596600  0.815944  
3  1.916053  2.336654  3.081734  
4  1.396233  2.131565  1.927165  
#########################
##### Fold 2 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 43,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('FOODS_1',), 1/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0533144
[200]	valid_0's WRMSSE: 0.0527319
[300]	valid_0's WRMSSE: 0.0527667
Early stopping, best iteration is:
[241]	valid_0's WRMSSE: 0.0526321


Group ID: ('FOODS_2',), 2/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.135965
[200]	valid_0's WRMSSE: 0.133848
[300]	valid_0's WRMSSE: 0.133554
Early stopping, best iteration is:
[288]	valid_0's WRMSSE: 0.133519


Group ID: ('FOODS_3',), 3/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.295282
[200]	valid_0's WRMSSE: 0.291247
[300]	valid_0's WRMSSE: 0.29012
[400]	valid_0's WRMSSE: 0.28982
[500]	valid_0's WRMSSE: 0.289803
Early stopping, best iteration is:
[493]	valid_0's WRMSSE: 0.289653


Group ID: ('HOBBIES_1',), 4/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0968018
[200]	valid_0's WRMSSE: 0.0960642
[300]	valid_0's WRMSSE: 0.0959369
[400]	valid_0's WRMSSE: 0.0958545
[500]	valid_0's WRMSSE: 0.0958651
Early stopping, best iteration is:
[446]	valid_0's WRMSSE: 0.0958184


Group ID: ('HOBBIES_2',), 5/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.00497286
[200]	valid_0's WRMSSE: 0.00496118
Early stopping, best iteration is:
[161]	valid_0's WRMSSE: 0.00495798


Group ID: ('HOUSEHOLD_1',), 6/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.213766
[200]	valid_0's WRMSSE: 0.197207
[300]	valid_0's WRMSSE: 0.194123
[400]	valid_0's WRMSSE: 0.193064
[500]	valid_0's WRMSSE: 0.192718
[600]	valid_0's WRMSSE: 0.192708
[700]	valid_0's WRMSSE: 0.192727
[800]	valid_0's WRMSSE: 0.192598
[900]	valid_0's WRMSSE: 0.192648
Early stopping, best iteration is:
[809]	valid_0's WRMSSE: 0.192573


Group ID: ('HOUSEHOLD_2',), 7/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0628241
[200]	valid_0's WRMSSE: 0.0605584
[300]	valid_0's WRMSSE: 0.0599959
[400]	valid_0's WRMSSE: 0.0597288
[500]	valid_0's WRMSSE: 0.059591
[600]	valid_0's WRMSSE: 0.0595176
[700]	valid_0's WRMSSE: 0.0594785
[800]	valid_0's WRMSSE: 0.0594722
Early stopping, best iteration is:
[775]	valid_0's WRMSSE: 0.0594566

Dump pickle to result/model/v08003.pkl.


--- Evaluation ---


Load pickle from result/model/v08003.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08003.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.0878575035795093
Our val WRMSSE score is 0.6190445115472424


--- Submission ---


Load pickle from result/model/v08003.pkl.
Load pickle from result/feature_cols/v08003.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.771365  0.967190  1.021842  1.246093   
1  HOBBIES_1_002_CA_1_validation  0.156398  0.134043  0.171902  0.204491   
2  HOBBIES_1_003_CA_1_validation  0.258527  0.387496  0.441093  0.390507   
3  HOBBIES_1_004_CA_1_validation  1.394703  1.254789  1.256281  1.504952   
4  HOBBIES_1_005_CA_1_validation  0.883620  0.672775  0.975631  0.874325   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.967143  1.405109  1.794936  0.503861  0.518365  0.582252  0.415226   
1  0.202131  0.220915  0.238537  0.237626  0.394353  0.342147  0.239855   
2  0.534652  0.592975  0.622442  0.323585  0.336280  0.273532  0.524334   
3  1.647544  2.166326  3.303168  1.693243  1.334934  1.405259  1.980384   
4  0.878008  1.115413  1.151771  1.205384  1.025405  0.872066  0.946814   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.549103  0.989619  0.522027  0.746730  0.574245  0.630904  0.675269   
1  0.365393  0.332289  0.281418  0.204529  0.255501  0.243824  0.229460   
2  0.393353  1.079817  0.701776  0.409556  0.506321  0.496687  0.508506   
3  2.090549  2.949747  2.937742  1.396527  1.072041  1.025788  1.197731   
4  0.952154  1.874603  1.306555  0.722084  0.705894  0.792827  0.803356   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.655884  1.249877  0.610512  0.590674  0.548129  0.452277  0.586679   
1  0.177512  0.396424  0.360492  0.235783  0.234629  0.204835  0.331036   
2  0.840069  0.728169  0.748709  0.483198  0.353219  0.498765  0.847719   
3  1.103072  2.140989  1.898545  1.933616  1.539707  1.456826  1.392546   
4  0.802914  1.021844  1.020080  1.132487  0.959426  1.212107  1.259034   

        F26       F27       F28  
0  0.722473  0.707058  0.750867  
1  0.282224  0.362229  0.363063  
2  0.820694  0.591264  0.924536  
3  2.029714  2.525754  3.941610  
4  1.384658  2.252206  1.880236  
#########################
##### Fold 3 / 3
#########################


--- Train ---


Load pickle from features/evaluator.pkl.

Parameters:
 {
    "boosting": "gbdt",
    "objective": "tweedie",
    "tweedie_variance_power": 1,
    "metric": "custom",
    "num_leaves": 127,
    "min_data_in_leaf": 50,
    "seed": 45,
    "learning_rate": 0.03,
    "subsample": 0.5,
    "subsample_freq": 1,
    "feature_fraction": 0.5,
    "lambda_l2": 0.1,
    "max_bin": 100,
    "force_row_wise": true,
    "verbose": -1
} 



Group ID: ('FOODS_1',), 1/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0529135
[200]	valid_0's WRMSSE: 0.0525378
Early stopping, best iteration is:
[176]	valid_0's WRMSSE: 0.0524826


Group ID: ('FOODS_2',), 2/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.136378
[200]	valid_0's WRMSSE: 0.134411
[300]	valid_0's WRMSSE: 0.134287
[400]	valid_0's WRMSSE: 0.134263
Early stopping, best iteration is:
[344]	valid_0's WRMSSE: 0.134175


Group ID: ('FOODS_3',), 3/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.295667
[200]	valid_0's WRMSSE: 0.290959
[300]	valid_0's WRMSSE: 0.289401
[400]	valid_0's WRMSSE: 0.288828
[500]	valid_0's WRMSSE: 0.288716
Early stopping, best iteration is:
[482]	valid_0's WRMSSE: 0.288572


Group ID: ('HOBBIES_1',), 4/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0966776
[200]	valid_0's WRMSSE: 0.0959034
[300]	valid_0's WRMSSE: 0.0956429
[400]	valid_0's WRMSSE: 0.0956388
Early stopping, best iteration is:
[340]	valid_0's WRMSSE: 0.0956143


Group ID: ('HOBBIES_2',), 5/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.00494728
[200]	valid_0's WRMSSE: 0.00493197
[300]	valid_0's WRMSSE: 0.00493246
Early stopping, best iteration is:
[230]	valid_0's WRMSSE: 0.00492973


Group ID: ('HOUSEHOLD_1',), 6/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.213573
[200]	valid_0's WRMSSE: 0.197252
[300]	valid_0's WRMSSE: 0.193947
[400]	valid_0's WRMSSE: 0.192924
[500]	valid_0's WRMSSE: 0.192437
[600]	valid_0's WRMSSE: 0.192497
Early stopping, best iteration is:
[530]	valid_0's WRMSSE: 0.192362


Group ID: ('HOUSEHOLD_2',), 7/7
Dump pickle to result/feature_cols/v08003.pkl.
[LightGBM] [Info] Saving data to binary file tmp_train_set.bin
[LightGBM] [Info] Saving data to binary file tmp_valid_set.bin
Training until validation scores don't improve for 100 rounds
[100]	valid_0's WRMSSE: 0.0628461
[200]	valid_0's WRMSSE: 0.0606054
[300]	valid_0's WRMSSE: 0.0599839
[400]	valid_0's WRMSSE: 0.0597199
[500]	valid_0's WRMSSE: 0.0595867
[600]	valid_0's WRMSSE: 0.0595041
[700]	valid_0's WRMSSE: 0.0594624
[800]	valid_0's WRMSSE: 0.0594483
[900]	valid_0's WRMSSE: 0.0594281
[1000]	valid_0's WRMSSE: 0.0594212
[1100]	valid_0's WRMSSE: 0.0594063
[1200]	valid_0's WRMSSE: 0.0594013
Early stopping, best iteration is:
[1183]	valid_0's WRMSSE: 0.0593985

Dump pickle to result/model/v08003.pkl.


--- Evaluation ---


Load pickle from result/model/v08003.pkl.
Load pickle from features/evaluator.pkl.
Load pickle from result/feature_cols/v08003.pkl.
Load pickle from features/eval_data.pkl.

Our val RMSE score is 2.0845198990510085
Our val WRMSSE score is 0.607192462757938


--- Submission ---


Load pickle from result/model/v08003.pkl.
Load pickle from result/feature_cols/v08003.pkl.
Load pickle from features/submit_data.pkl.
(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.758949  0.923751  1.003066  1.263478   
1  HOBBIES_1_002_CA_1_validation  0.154254  0.126840  0.160953  0.200743   
2  HOBBIES_1_003_CA_1_validation  0.286610  0.402321  0.472865  0.390764   
3  HOBBIES_1_004_CA_1_validation  1.361996  1.289886  1.268755  1.387424   
4  HOBBIES_1_005_CA_1_validation  0.907058  0.720231  0.975281  0.905960   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.960664  1.554282  2.056744  0.549266  0.623029  0.632564  0.440547   
1  0.187568  0.210281  0.234784  0.244184  0.432599  0.365498  0.279658   
2  0.540076  0.598787  0.598954  0.344660  0.364271  0.292610  0.504098   
3  1.633240  1.747401  2.602236  1.668450  1.482447  1.480057  1.756542   
4  0.933663  1.197778  1.265931  1.275619  1.087213  0.930523  0.923521   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.615749  1.007725  0.585235  0.870564  0.614462  0.601178  0.733899   
1  0.384025  0.312522  0.321262  0.215459  0.268102  0.257986  0.247670   
2  0.401793  0.938876  0.614336  0.411741  0.504683  0.479599  0.484934   
3  2.063254  2.836347  2.425622  1.256947  1.059646  1.117719  1.158277   
4  1.034651  1.798909  1.476524  0.705164  0.720221  0.756865  0.808110   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.703173  1.237493  0.688535  0.633536  0.592837  0.464306  0.662786   
1  0.179927  0.383607  0.367448  0.233789  0.240248  0.215113  0.348427   
2  0.781060  0.721955  0.719864  0.490973  0.378006  0.509265  0.799076   
3  1.125513  1.969650  1.774132  1.782982  1.409820  1.396653  1.390301   
4  0.837732  1.065822  1.034809  1.174141  1.030795  1.423736  1.383904   

        F26       F27       F28  
0  0.748999  0.711048  0.795375  
1  0.269720  0.346103  0.363287  
2  0.806254  0.582593  0.804992  
3  1.874788  2.672165  3.041461  
4  1.431395  2.440322  2.113055  
