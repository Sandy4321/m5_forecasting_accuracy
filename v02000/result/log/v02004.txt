

--- Load Data and Initial Processing ---


Load Cached data, features/parse_calendar.pkl
Load Cached data, features/parse_sell_prices.pkl
Load Cached data, features/parse_sales_train.pkl


--- Transform ---


Load Cached data, features/melted_and_merged_train.pkl


--- Feature Engineering ---


Load Cached data, features/simple_fe.pkl
id                                 object
item_id                          category
dept_id                          category
cat_id                           category
store_id                         category
state_id                         category
d                                  object
sales                               int16
date                       datetime64[ns]
wm_yr_wk                            int16
weekday                            object
wday                                 int8
month                            category
year                                int16
event_name_1                     category
event_type_1                     category
event_name_2                     category
event_type_2                     category
snap_CA                              int8
snap_TX                              int8
snap_WI                              int8
quarter                          category
week                             category
weekofyear                       category
day                              category
dayofweek                        category
is_year_end                          bool
is_year_start                        bool
is_quarter_end                       bool
is_quarter_start                     bool
is_month_end                         bool
is_month_start                       bool
sell_price                        float16
sales_lag_t28                     float16
sales_lag_t29                     float16
sales_lag_t30                     float16
sales_rolling_mean_t7             float16
sales_rolling_std_t7              float16
sales_rolling_mean_t30            float16
sales_rolling_mean_t90            float16
sales_rolling_mean_t180           float16
sales_rolling_std_t30             float16
sales_rolling_skew_t30            float16
sales_rolling_kurt_t30            float16
price_change_t1                   float16
price_change_t365                 float16
price_rolling_std_t7              float16
price_rolling_std_t30             float16
dtype: object 



--- Define Evaluation Object ---


Load Cached data, features/evaluator.pkl


--- Train Model ---


{
    "boosting_type": "gbdt",
    "metric": "rmse",
    "objective": "poisson",
    "seed": 42,
    "learning_rate": 0.1,
    "bagging_fraction": 0.7,
    "bagging_freq": 5,
    "verbosity": -1
} 

Training until validation scores don't improve for 50 rounds
[100]	training's rmse: 2.89383	valid_1's rmse: 5.67994
[200]	training's rmse: 2.5911	valid_1's rmse: 3.50617
Early stopping, best iteration is:
[210]	training's rmse: 2.57449	valid_1's rmse: 3.45531


--- Evaluation ---


Our val RMSE score is 2.259460828241168
Our val WRMSSE score is 0.5939572662059521


--- Submission ---


(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.874477  0.732847  0.709979  0.683019   
1  HOBBIES_1_002_CA_1_validation  0.380534  0.356353  0.351178  0.337049   
2  HOBBIES_1_003_CA_1_validation  0.378139  0.343964  0.344158  0.337854   
3  HOBBIES_1_004_CA_1_validation  1.774091  1.524899  1.492811  1.371542   
4  HOBBIES_1_005_CA_1_validation  0.926224  0.769685  0.922622  0.982458   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.740266  0.898224  0.924596  0.677701  0.792464  0.792206  0.901991   
1  0.370911  0.455323  0.448747  0.280835  0.262960  0.242113  0.241017   
2  0.361158  0.406618  0.511299  0.301653  0.299328  0.275412  0.291271   
3  1.808454  2.010969  2.116052  1.559991  1.596909  1.424058  1.392300   
4  1.018507  1.418187  1.766516  1.222660  1.223673  0.990494  0.962311   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.943232  1.266329  1.200160  1.011456  0.783808  0.765732  0.774291   
1  0.263421  0.324890  0.294414  0.249801  0.234034  0.232873  0.231785   
2  0.311525  0.399782  0.359666  0.295591  0.274735  0.282649  0.312833   
3  1.703519  2.459322  2.249122  1.983274  1.607492  1.756391  1.681482   
4  1.017207  1.412067  1.184062  1.082154  0.903611  0.922980  0.934985   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.874560  1.215387  1.067575  0.846748  0.763134  0.777748  0.875649   
1  0.252098  0.311079  0.309410  0.248817  0.231766  0.285386  0.272521   
2  0.375915  0.478174  0.544115  0.413524  0.397889  0.402363  0.393653   
3  1.875323  2.110565  2.368071  1.844955  1.646210  1.487100  1.526673   
4  1.102241  1.391697  1.348866  0.951125  0.910896  0.899509  0.942589   

        F26       F27       F28  
0  0.865446  1.095554  1.117428  
1  0.292740  0.359386  0.352101  
2  0.457853  0.594715  0.589064  
3  1.841421  2.658048  2.464781  
4  1.061174  1.373590  1.649904  
