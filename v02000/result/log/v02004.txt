

--- Load Data and Initial Processing ---


Load Cached data, features/parse_calendar.pkl
Load Cached data, features/parse_sell_prices.pkl
Load Cached data, features/parse_sales_train.pkl


--- Transform ---


Load Cached data, features/melted_and_merged_train.pkl


--- Feature Engineering ---


Load Cached data, features/simple_fe.pkl
id                                 object
item_id                          category
dept_id                          category
cat_id                           category
store_id                         category
state_id                         category
d                                  object
sales                               int16
date                       datetime64[ns]
wm_yr_wk                            int16
weekday                            object
wday                                 int8
month                            category
year                                int16
event_name_1                     category
event_type_1                     category
event_name_2                     category
event_type_2                     category
snap_CA                              int8
snap_TX                              int8
snap_WI                              int8
quarter                          category
week                             category
day                              category
dayofweek                        category
is_year_end                          bool
is_year_start                        bool
is_quarter_end                       bool
is_quarter_start                     bool
is_month_end                         bool
is_month_start                       bool
sell_price                        float16
sales_lag_t28                     float16
sales_lag_t29                     float16
sales_lag_t30                     float16
sales_rolling_mean_t7             float16
sales_rolling_std_t7              float16
sales_rolling_mean_t30            float16
sales_rolling_mean_t90            float16
sales_rolling_mean_t180           float16
sales_rolling_std_t30             float16
sales_rolling_skew_t30            float16
sales_rolling_kurt_t30            float16
price_change_t1                   float16
price_change_t365                 float16
price_rolling_std_t7              float16
price_rolling_std_t30             float16
dtype: object 



--- Define Evaluation Object ---


Load Cached data, features/evaluator.pkl


--- Train Model ---


{
    "boosting_type": "gbdt",
    "metric": "rmse",
    "objective": "tweedie",
    "seed": 42,
    "learning_rate": 0.1,
    "num_leaves": 2047,
    "bagging_fraction": 0.7,
    "bagging_freq": 5,
    "min_data_in_leaf": 50,
    "verbosity": -1
} 

Training until validation scores don't improve for 50 rounds
[100]	training's rmse: 1.14682	valid_1's rmse: 1.346
Early stopping, best iteration is:
[66]	training's rmse: 1.16704	valid_1's rmse: 1.33994


--- Evaluation ---


Our val RMSE score is 2.179766074699494
Our val WRMSSE score is 0.6953796510513385


--- Submission ---


(60980, 29)
                              id        F1        F2        F3        F4  \
0  HOBBIES_1_001_CA_1_validation  0.820769  0.718622  0.715466  0.697763   
1  HOBBIES_1_002_CA_1_validation  0.384659  0.339289  0.327009  0.307211   
2  HOBBIES_1_003_CA_1_validation  0.497697  0.468628  0.465555  0.448299   
3  HOBBIES_1_004_CA_1_validation  1.885820  1.613885  1.476344  1.367881   
4  HOBBIES_1_005_CA_1_validation  0.978340  0.787191  0.894039  0.980360   

         F5        F6        F7        F8        F9       F10       F11  \
0  0.795426  0.843631  0.965751  0.697229  0.841078  0.794480  0.857192   
1  0.347902  0.413822  0.436962  0.331992  0.292465  0.273769  0.268636   
2  0.499758  0.566630  0.715962  0.423562  0.406921  0.389770  0.366496   
3  1.771056  2.013114  2.062459  1.741386  1.650068  1.541195  1.482600   
4  1.029951  1.324023  1.539662  1.161268  1.168725  1.008549  0.923706   

        F12       F13       F14       F15       F16       F17       F18  \
0  0.928766  1.129732  1.074142  0.896618  0.784054  0.728055  0.755873   
1  0.285593  0.346612  0.311106  0.227434  0.224003  0.215923  0.212361   
2  0.390582  0.502337  0.444022  0.334274  0.332321  0.354427  0.411794   
3  1.692591  2.489519  2.459102  1.900880  1.572182  1.608679  1.618046   
4  1.015998  1.330211  1.167916  0.995397  0.920200  0.856131  0.862402   

        F19       F20       F21       F22       F23       F24       F25  \
0  0.906894  1.141743  1.059789  0.870592  0.784601  0.779383  0.847210   
1  0.233914  0.299821  0.293178  0.229447  0.222295  0.281115  0.266167   
2  0.509182  0.669106  0.731312  0.697750  0.638634  0.647461  0.563926   
3  1.825797  1.993829  2.329658  1.902580  1.629894  1.482451  1.536784   
4  1.091090  1.294411  1.280034  1.004941  0.905325  0.900233  0.918003   

        F26       F27       F28  
0  0.912623  1.069381  1.127940  
1  0.276490  0.330592  0.333290  
2  0.643181  0.756864  0.780837  
3  1.874957  2.610240  2.458948  
4  1.073779  1.389247  1.537423  
