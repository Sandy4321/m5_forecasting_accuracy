

 ====================================================================================================

RUNNING at 2020-04-11 12:55:05.664646


--- Load Data ---

Loading and initial processing have already been completed.

--- Transfrom Data ---

processing encode_map.
processing parse_sell_price.
processing encode_calendar.
processing melt_data.

Train DataFrame: (46881677, 51)
Memory Usage: 4336.855694770813 Mb
                              id  ...  price_momentum_year
0  HOBBIES_1_008_CA_1_validation  ...             0.950195
1  HOBBIES_1_009_CA_1_validation  ...             0.896484
2  HOBBIES_1_010_CA_1_validation  ...             1.043945
3  HOBBIES_1_012_CA_1_validation  ...             0.959473
4  HOBBIES_1_015_CA_1_validation  ...             1.001953

[5 rows x 51 columns]

--- Feature Engineering ---

Add Sales Feature.
Add Price Feature.
Add Weight.
Mem. usage decreased to 6179.51 Mb (3.6% reduction)
Train DataFrame: (39752692, 80)
Memory Usage: 5876.223934173584 Mb
                              id  ...    weight
0  HOBBIES_1_008_CA_1_validation  ...  0.678711
1  HOBBIES_1_009_CA_1_validation  ...  0.714355
2  HOBBIES_1_010_CA_1_validation  ...  0.142822
3  HOBBIES_1_012_CA_1_validation  ...  0.392822
4  HOBBIES_1_015_CA_1_validation  ...  0.500000

[5 rows x 80 columns]

--- Train Model ---

Cross Validation Parameters:
{'n_splits': 5, 'train_days': 730, 'test_days': 90, 'dt_col': 'date'}

Model Parameters:
{'boosting_type': 'gbdt', 'metric': 'None', 'objective': 'poisson', 'seed': 11, 'learning_rate': 0.3, 'max_depth': 7, 'num_leaves': 128, 'min_data_in_leaf': 50, 'bagging_fraction': 0.8, 'bagging_freq': 10, 'feature_fraction': 0.8, 'verbosity': -1}

1 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's WRMSLE: 0.649017	valid's WRMSLE: 0.655692
[200]	train's WRMSLE: 0.640767	valid's WRMSLE: 0.651366
[300]	train's WRMSLE: 0.635681	valid's WRMSLE: 0.649949
[400]	train's WRMSLE: 0.631522	valid's WRMSLE: 0.649456
Early stopping, best iteration is:
[390]	train's WRMSLE: 0.631904	valid's WRMSLE: 0.649348

2 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's WRMSLE: 0.645773	valid's WRMSLE: 0.672699
[200]	train's WRMSLE: 0.638175	valid's WRMSLE: 0.670223
[300]	train's WRMSLE: 0.633882	valid's WRMSLE: 0.66899
Early stopping, best iteration is:
[309]	train's WRMSLE: 0.63358	valid's WRMSLE: 0.668791

3 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's WRMSLE: 0.647825	valid's WRMSLE: 0.636761
[200]	train's WRMSLE: 0.638474	valid's WRMSLE: 0.632421
[300]	train's WRMSLE: 0.632967	valid's WRMSLE: 0.631324
[400]	train's WRMSLE: 0.629396	valid's WRMSLE: 0.629984
[500]	train's WRMSLE: 0.626378	valid's WRMSLE: 0.630071
Early stopping, best iteration is:
[491]	train's WRMSLE: 0.626601	valid's WRMSLE: 0.629688

4 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's WRMSLE: 0.638073	valid's WRMSLE: 0.620523
[200]	train's WRMSLE: 0.630303	valid's WRMSLE: 0.617366
[300]	train's WRMSLE: 0.625693	valid's WRMSLE: 0.614881
[400]	train's WRMSLE: 0.621478	valid's WRMSLE: 0.613594
[500]	train's WRMSLE: 0.618042	valid's WRMSLE: 0.612752
[600]	train's WRMSLE: 0.615209	valid's WRMSLE: 0.611297
[700]	train's WRMSLE: 0.612671	valid's WRMSLE: 0.610561
[800]	train's WRMSLE: 0.610157	valid's WRMSLE: 0.610034
[900]	train's WRMSLE: 0.607746	valid's WRMSLE: 0.609099
[1000]	train's WRMSLE: 0.605916	valid's WRMSLE: 0.608837
Early stopping, best iteration is:
[1007]	train's WRMSLE: 0.605738	valid's WRMSLE: 0.608701

5 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's WRMSLE: 0.626171	valid's WRMSLE: 0.610372
Early stopping, best iteration is:
[118]	train's WRMSLE: 0.624305	valid's WRMSLE: 0.609919

--- Evaluation ---

RMSE: 49.841076934864454
RMSLE: 0.5269081942080951
WRMSSE: 111111

--- Submission ---



====================================================================================================

RUNNING at 2020-04-11 16:05:08.457330


--- Load Data ---

Loading and initial processing have already been completed.

--- Transfrom Data ---

processing encode_map.
processing parse_sell_price.
processing encode_calendar.
processing melt_data.

Train DataFrame: (46881677, 51)
Memory Usage: 4336.855694770813 Mb
                              id  ...  price_momentum_year
0  HOBBIES_1_008_CA_1_validation  ...             0.950195
1  HOBBIES_1_009_CA_1_validation  ...             0.896484
2  HOBBIES_1_010_CA_1_validation  ...             1.043945
3  HOBBIES_1_012_CA_1_validation  ...             0.959473
4  HOBBIES_1_015_CA_1_validation  ...             1.001953

[5 rows x 51 columns]

--- Feature Engineering ---

Add Sales Feature.
Add Price Feature.
Add Weight.
Mem. usage decreased to 6930.03 Mb (3.7% reduction)
Train DataFrame: (46881677, 80)
Memory Usage: 6930.027068138123 Mb
                              id  ...  weight
0  HOBBIES_1_008_CA_1_validation  ...     NaN
1  HOBBIES_1_009_CA_1_validation  ...     NaN
2  HOBBIES_1_010_CA_1_validation  ...     NaN
3  HOBBIES_1_012_CA_1_validation  ...     NaN
4  HOBBIES_1_015_CA_1_validation  ...     NaN

[5 rows x 80 columns]

--- Train Model ---

Cross Validation Parameters:
{'n_splits': 5, 'train_days': 730, 'test_days': 90, 'dt_col': 'date'}

Model Parameters:
{'boosting_type': 'gbdt', 'metric': 'None', 'objective': 'poisson', 'seed': 11, 'learning_rate': 0.3, 'max_depth': 7, 'num_leaves': 128, 'min_data_in_leaf': 50, 'bagging_fraction': 0.8, 'bagging_freq': 10, 'feature_fraction': 0.8, 'verbosity': -1}

1 of 5 Fold:

Training until validation scores don't improve for 50 rounds
Early stopping, best iteration is:
[2]	train's RMSLE: 1.00553	valid's RMSLE: 1.01163

2 of 5 Fold:

Training until validation scores don't improve for 50 rounds
Early stopping, best iteration is:
[33]	train's RMSLE: 0.603406	valid's RMSLE: 0.571389

3 of 5 Fold:

Training until validation scores don't improve for 50 rounds


====================================================================================================

RUNNING at 2020-04-11 16:42:40.545732


--- Load Data ---

Loading and initial processing have already been completed.

--- Transfrom Data ---

processing encode_map.
processing parse_sell_price.
processing encode_calendar.
processing melt_data.

Train DataFrame: (46881677, 51)
Memory Usage: 4336.855694770813 Mb
                              id  ...  price_momentum_year
0  HOBBIES_1_008_CA_1_validation  ...             0.950195
1  HOBBIES_1_009_CA_1_validation  ...             0.896484
2  HOBBIES_1_010_CA_1_validation  ...             1.043945
3  HOBBIES_1_012_CA_1_validation  ...             0.959473
4  HOBBIES_1_015_CA_1_validation  ...             1.001953

[5 rows x 51 columns]

--- Feature Engineering ---

Add Sales Feature.
Add Price Feature.
Add Weight.
Mem. usage decreased to 7027.03 Mb (3.6% reduction)
Train DataFrame: (45204727, 80)
Memory Usage: 6682.141125679016 Mb
                              id  ...    weight
0  HOBBIES_1_008_CA_1_validation  ...  0.678711
1  HOBBIES_1_009_CA_1_validation  ...  0.714355
2  HOBBIES_1_010_CA_1_validation  ...  0.142822
3  HOBBIES_1_012_CA_1_validation  ...  0.392822
4  HOBBIES_1_015_CA_1_validation  ...  0.500000

[5 rows x 80 columns]

--- Train Model ---

Cross Validation Parameters:
{'n_splits': 5, 'train_days': 730, 'test_days': 90, 'dt_col': 'date'}

Model Parameters:
{'boosting_type': 'gbdt', 'metric': 'None', 'objective': 'poisson', 'seed': 11, 'learning_rate': 0.3, 'max_depth': 7, 'num_leaves': 128, 'min_data_in_leaf': 50, 'bagging_fraction': 0.8, 'bagging_freq': 10, 'feature_fraction': 0.8, 'verbosity': -1}

1 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's RMSLE: 0.557414	valid's RMSLE: 0.555982
Early stopping, best iteration is:
[89]	train's RMSLE: 0.554396	valid's RMSLE: 0.551407

2 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's RMSLE: 0.545416	valid's RMSLE: 0.548619
Early stopping, best iteration is:
[112]	train's RMSLE: 0.544365	valid's RMSLE: 0.547681

3 of 5 Fold:kj

Training until validation scores don't improve for 50 rounds
[100]	train's RMSLE: 0.55713	valid's RMSLE: 0.592166
Early stopping, best iteration is:
[85]	train's RMSLE: 0.540145	valid's RMSLE: 0.528615

4 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's RMSLE: 0.533484	valid's RMSLE: 0.524553
[200]	train's RMSLE: 0.528487	valid's RMSLE: 0.522224
[300]	train's RMSLE: 0.528912	valid's RMSLE: 0.522365
Early stopping, best iteration is:
[262]	train's RMSLE: 0.527766	valid's RMSLE: 0.521281

5 of 5 Fold:

Training until validation scores don't improve for 50 rounds
[100]	train's RMSLE: 0.525439	valid's RMSLE: 0.52744
Early stopping, best iteration is:
[123]	train's RMSLE: 0.523759	valid's RMSLE: 0.527005

--- Evaluation ---

RMSE: 2.2041845139520113
RMSLE: 0.5234763492320385
WRMSSE: 111111

--- Submission ---

